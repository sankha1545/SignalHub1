{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///E:/Attack%20Capital/SignalHub/frontend/src/app/api/auth/clear-sessions/route.ts"],"sourcesContent":["// src/app/api/auth/clear-sessions/route.ts\r\nimport { NextResponse } from \"next/server\";\r\n\r\n/**\r\n * Temporary utility to clear auth cookies from the browser.\r\n * Visit /api/auth/clear-sessions to remove old 'token' and 'session' cookies.\r\n */\r\nexport async function GET(request: Request) {\r\n  // Build an absolute URL for redirect using incoming request as base\r\n  const base = request.headers.get(\"x-forwarded-host\") ?? request.headers.get(\"host\") ?? \"localhost:3000\";\r\n  const proto = request.headers.get(\"x-forwarded-proto\") ?? (process.env.NODE_ENV === \"production\" ? \"https\" : \"http\");\r\n  const origin = `${proto}://${base}`;\r\n  const redirectTo = new URL(\"/\", origin).toString();\r\n\r\n  const res = NextResponse.redirect(redirectTo);\r\n\r\n  const isProd = process.env.NODE_ENV === \"production\";\r\n  const sameSite = isProd ? \"none\" : \"lax\";\r\n  const secure = isProd;\r\n\r\n  // Clear legacy \"token\" cookie (if present)\r\n  try {\r\n    res.cookies.set(\"token\", \"\", {\r\n      path: \"/\",\r\n      maxAge: 0,\r\n      sameSite: sameSite as any,\r\n      secure,\r\n    });\r\n  } catch {\r\n    const parts = [\r\n      `token=`,\r\n      \"Path=/\",\r\n      \"Max-Age=0\",\r\n      isProd ? \"SameSite=None\" : \"SameSite=Lax\",\r\n      secure ? \"Secure\" : \"\",\r\n    ].filter(Boolean);\r\n    res.headers.append(\"Set-Cookie\", parts.join(\"; \"));\r\n  }\r\n\r\n  // Clear canonical \"session\" cookie\r\n  try {\r\n    res.cookies.set(\"session\", \"\", {\r\n      path: \"/\",\r\n      maxAge: 0,\r\n      sameSite: sameSite as any,\r\n      secure,\r\n    });\r\n  } catch {\r\n    const parts = [\r\n      `session=`,\r\n      \"Path=/\",\r\n      \"Max-Age=0\",\r\n      isProd ? \"SameSite=None\" : \"SameSite=Lax\",\r\n      secure ? \"Secure\" : \"\",\r\n    ].filter(Boolean);\r\n    res.headers.append(\"Set-Cookie\", parts.join(\"; \"));\r\n  }\r\n\r\n  return res;\r\n}\r\n"],"names":[],"mappings":"AAAA,2CAA2C;;;;;AAC3C;;AAMO,eAAe,IAAI,OAAgB;IACxC,oEAAoE;IACpE,MAAM,OAAO,QAAQ,OAAO,CAAC,GAAG,CAAC,uBAAuB,QAAQ,OAAO,CAAC,GAAG,CAAC,WAAW;IACvF,MAAM,QAAQ,QAAQ,OAAO,CAAC,GAAG,CAAC,wBAAwB,CAAC,sCAAwC,0BAAU,MAAM;IACnH,MAAM,SAAS,GAAG,MAAM,GAAG,EAAE,MAAM;IACnC,MAAM,aAAa,IAAI,IAAI,KAAK,QAAQ,QAAQ;IAEhD,MAAM,MAAM,gJAAY,CAAC,QAAQ,CAAC;IAElC,MAAM,SAAS,oDAAyB;IACxC,MAAM,WAAW,sCAAS,0BAAS;IACnC,MAAM,SAAS;IAEf,2CAA2C;IAC3C,IAAI;QACF,IAAI,OAAO,CAAC,GAAG,CAAC,SAAS,IAAI;YAC3B,MAAM;YACN,QAAQ;YACR,UAAU;YACV;QACF;IACF,EAAE,OAAM;QACN,MAAM,QAAQ;YACZ,CAAC,MAAM,CAAC;YACR;YACA;YACA,sCAAS,0BAAkB;YAC3B,sCAAS,0BAAW;SACrB,CAAC,MAAM,CAAC;QACT,IAAI,OAAO,CAAC,MAAM,CAAC,cAAc,MAAM,IAAI,CAAC;IAC9C;IAEA,mCAAmC;IACnC,IAAI;QACF,IAAI,OAAO,CAAC,GAAG,CAAC,WAAW,IAAI;YAC7B,MAAM;YACN,QAAQ;YACR,UAAU;YACV;QACF;IACF,EAAE,OAAM;QACN,MAAM,QAAQ;YACZ,CAAC,QAAQ,CAAC;YACV;YACA;YACA,sCAAS,0BAAkB;YAC3B,sCAAS,0BAAW;SACrB,CAAC,MAAM,CAAC;QACT,IAAI,OAAO,CAAC,MAAM,CAAC,cAAc,MAAM,IAAI,CAAC;IAC9C;IAEA,OAAO;AACT","debugId":null}}]
}