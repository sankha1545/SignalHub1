{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///E:/Attack%20Capital/SignalHub/frontend/src/components/ui/modal.tsx"],"sourcesContent":["// components/ui/modal.tsx\r\n\"use client\";\r\n\r\nimport React, { useEffect, useRef } from \"react\";\r\nimport { createPortal } from \"react-dom\";\r\nimport { motion, AnimatePresence } from \"framer-motion\";\r\nimport clsx from \"clsx\";\r\nimport { X } from \"lucide-react\";\r\n\r\n/**\r\n * Improved Modal primitive\r\n *\r\n * Props:\r\n *  - children: content inside modal (panel)\r\n *  - onClose: called when modal requests close (ESC, backdrop click, close button)\r\n *  - ariaLabel: string for aria-label on the dialog (default: \"Dialog\")\r\n *  - className: optional className to apply to panel (merged with defaults)\r\n *\r\n * Behavior:\r\n *  - renders into document.body using a portal\r\n *  - traps focus (Tab / Shift+Tab)\r\n *  - ESC closes modal\r\n *  - click on backdrop closes modal\r\n *  - locks body scroll while open\r\n *  - provides built-in animated close button and subtle entrance/exit animations\r\n */\r\n\r\ntype ModalProps = {\r\n  children: React.ReactNode;\r\n  onClose: () => void;\r\n  ariaLabel?: string;\r\n  className?: string;\r\n};\r\n\r\nconst FOCUSABLE_SELECTOR =\r\n  'a[href], area[href], input:not([disabled]):not([type=\"hidden\"]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, [tabindex]:not([tabindex=\"-1\"]), [contenteditable]';\r\n\r\nconst getFocusableElements = (container: HTMLElement | null) => {\r\n  if (!container) return [];\r\n  try {\r\n    return Array.from(container.querySelectorAll<HTMLElement>(FOCUSABLE_SELECTOR)).filter(\r\n      (el) => !!(el.offsetWidth || el.offsetHeight || el.getClientRects().length)\r\n    );\r\n  } catch {\r\n    return [];\r\n  }\r\n};\r\n\r\nexport const Modal: React.FC<ModalProps> = ({ children, onClose, ariaLabel = \"Dialog\", className }) => {\r\n  const overlayRef = useRef<HTMLDivElement | null>(null);\r\n  const panelRef = useRef<HTMLDivElement | null>(null);\r\n  const lastFocused = useRef<HTMLElement | null>(null);\r\n\r\n  // ensure portal root exists\r\n  useEffect(() => {\r\n    let root = document.getElementById(\"modal-root\");\r\n    if (!root) {\r\n      root = document.createElement(\"div\");\r\n      root.id = \"modal-root\";\r\n      document.body.appendChild(root);\r\n    }\r\n  }, []);\r\n\r\n  // lock scroll + preserve/restore focus\r\n  useEffect(() => {\r\n    lastFocused.current = document.activeElement as HTMLElement | null;\r\n    const originalOverflow = document.body.style.overflow;\r\n    document.body.style.overflow = \"hidden\";\r\n\r\n    // focus the panel (or first focusable element) shortly after mount\r\n    const t = setTimeout(() => {\r\n      const focusable = getFocusableElements(panelRef.current);\r\n      if (focusable.length) focusable[0].focus();\r\n      else panelRef.current?.focus();\r\n    }, 30);\r\n\r\n    return () => {\r\n      clearTimeout(t);\r\n      document.body.style.overflow = originalOverflow;\r\n      try {\r\n        lastFocused.current?.focus();\r\n      } catch {\r\n        // ignore\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  // key handlers: ESC + focus trap (Tab / Shift+Tab)\r\n  useEffect(() => {\r\n    const onKey = (e: KeyboardEvent) => {\r\n      if (e.key === \"Escape\") {\r\n        e.preventDefault();\r\n        onClose();\r\n        return;\r\n      }\r\n      if (e.key === \"Tab\") {\r\n        const focusable = getFocusableElements(panelRef.current);\r\n        if (focusable.length === 0) {\r\n          e.preventDefault();\r\n          return;\r\n        }\r\n        const idx = focusable.indexOf(document.activeElement as HTMLElement);\r\n        if (e.shiftKey) {\r\n          if (idx === 0 || document.activeElement === panelRef.current) {\r\n            e.preventDefault();\r\n            focusable[focusable.length - 1].focus();\r\n          }\r\n        } else {\r\n          if (idx === focusable.length - 1) {\r\n            e.preventDefault();\r\n            focusable[0].focus();\r\n          }\r\n        }\r\n      }\r\n    };\r\n\r\n    document.addEventListener(\"keydown\", onKey);\r\n    return () => document.removeEventListener(\"keydown\", onKey);\r\n  }, [onClose]);\r\n\r\n  // backdrop click to close\r\n  const onBackdropMouseDown = (e: React.MouseEvent) => {\r\n    if (e.target === overlayRef.current) onClose();\r\n  };\r\n\r\n  // Motion variants for panel and backdrop\r\n  const backdropVariants = {\r\n    hidden: { opacity: 0 },\r\n    visible: { opacity: 0.5 },\r\n    exit: { opacity: 0 },\r\n  };\r\n\r\n  const panelVariants = {\r\n    hidden: { opacity: 0, y: 8, scale: 0.995 },\r\n    visible: { opacity: 1, y: 0, scale: 1 },\r\n    exit: { opacity: 0, y: 8, scale: 0.995 },\r\n  };\r\n\r\n  const modal = (\r\n    <AnimatePresence>\r\n      <div\r\n        ref={overlayRef}\r\n        onMouseDown={onBackdropMouseDown}\r\n        className=\"fixed inset-0 z-50 flex items-center justify-center p-4 sm:p-6\"\r\n        aria-hidden={false}\r\n      >\r\n        {/* Backdrop */}\r\n        <motion.div\r\n          key=\"backdrop\"\r\n          initial=\"hidden\"\r\n          animate=\"visible\"\r\n          exit=\"exit\"\r\n          variants={backdropVariants}\r\n          transition={{ duration: 0.18 }}\r\n          className=\"absolute inset-0 bg-black/60 backdrop-blur-sm\"\r\n        />\r\n\r\n        {/* Panel */}\r\n        <motion.div\r\n          key=\"panel\"\r\n          ref={panelRef}\r\n          role=\"dialog\"\r\n          aria-modal=\"true\"\r\n          aria-label={ariaLabel}\r\n          tabIndex={-1}\r\n          initial=\"hidden\"\r\n          animate=\"visible\"\r\n          exit=\"exit\"\r\n          variants={panelVariants}\r\n          transition={{ duration: 0.22, ease: \"easeOut\" }}\r\n          className={clsx(\r\n            // defaults: professional panel that matches team page design\r\n            \"relative z-10 w-full max-w-2xl rounded-2xl bg-white border border-slate-100 shadow-lg overflow-hidden outline-none\",\r\n            // safe max-height and internal scroll when needed\r\n            \"max-h-[90vh] overflow-auto\",\r\n            // allow consumer to pass additional width/padding overrides\r\n            className\r\n          )}\r\n          style={{ WebkitTapHighlightColor: \"transparent\" }}\r\n        >\r\n          {/* Panel inner: we provide a consistent padding layout for header/body/footer */}\r\n          <div className=\"relative\">\r\n            {/* Close button (top-right) */}\r\n            <button\r\n              aria-label=\"Close dialog\"\r\n              onClick={onClose}\r\n              className=\"absolute right-3 top-3 z-20 inline-flex items-center justify-center rounded-md p-1.5 text-slate-600 hover:bg-slate-100 hover:text-slate-800 transition\"\r\n              type=\"button\"\r\n            >\r\n              <X className=\"w-4 h-4\" />\r\n            </button>\r\n\r\n            {/* Content wrapper */}\r\n            <div className=\"p-4 sm:p-6\">\r\n              {/*\r\n                Children controls layout.\r\n                Consumers (e.g., Teams page) typically render their own header/body inside.\r\n                We provide consistent background and padding so the child's header fits perfectly.\r\n              */}\r\n              {children}\r\n            </div>\r\n          </div>\r\n        </motion.div>\r\n      </div>\r\n    </AnimatePresence>\r\n  );\r\n\r\n  const root = typeof window !== \"undefined\" ? document.getElementById(\"modal-root\") : null;\r\n  if (root) return createPortal(modal, root);\r\n\r\n  // Fallback inline render (shouldn't happen in client)\r\n  return modal as any;\r\n};\r\n\r\nexport default Modal;\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 237, "column": 0}, "map": {"version":3,"sources":["file:///E:/Attack%20Capital/SignalHub/frontend/src/app/dashboard/manager/People/page.tsx"],"sourcesContent":["// src/app/dashboard/manager/People/page.tsx\r\n\"use client\";\r\n\r\nimport React, { useEffect, useMemo, useRef, useState } from \"react\";\r\nimport { motion, AnimatePresence } from \"framer-motion\";\r\nimport {\r\n  Search,\r\n  User as UserIcon,\r\n  Users,\r\n  CheckCircle2,\r\n  MoreVertical,\r\n  Mail as MailIcon,\r\n  Phone as PhoneIcon,\r\n  Calendar,\r\n  Globe,\r\n  UserCheck,\r\n  UserPlus,\r\n  X as XIcon,\r\n} from \"lucide-react\";\r\n\r\nimport { Modal } from \"@/components/ui/modal\";\r\nimport dynamic from \"next/dynamic\";\r\nimport { useRouter } from \"next/navigation\";\r\n\r\n// TeamChat is client-only (heavy + socket)\r\nconst TeamChat = dynamic(\r\n  () => import(\"@/components/chat/TeamChat\").then((m) => m.default),\r\n  { ssr: false }\r\n);\r\n\r\n/* ============================\r\n   Types\r\n   ============================ */\r\ntype Role = \"Manager\" | \"Team Lead\" | \"Engineer\" | \"Support\" | \"Sales\" | string;\r\ntype Presence = \"online\" | \"away\" | \"offline\" | string;\r\n\r\ntype Person = {\r\n  id: string;\r\n  name: string;\r\n  role: Role;\r\n  presence: Presence;\r\n  email?: string | null;\r\n  phone?: string | null;\r\n  location?: string | null;\r\n  tasksAssigned?: number;\r\n  respondRate?: number; // percentage\r\n  hiredAt?: string; // human readable mock\r\n  starred?: boolean;\r\n  label?: { text: string; colorClass: string } | null;\r\n};\r\n\r\n/* ============================\r\n   Small accessible IconButton\r\n   ============================ */\r\nconst IconButton: React.FC<{\r\n  children: React.ReactNode;\r\n  ariaLabel?: string;\r\n  title?: string;\r\n  onClick?: (e: React.MouseEvent) => void;\r\n  className?: string;\r\n}> = ({ children, ariaLabel, title, onClick, className = \"\" }) => (\r\n  <button\r\n    type=\"button\"\r\n    aria-label={ariaLabel}\r\n    title={title}\r\n    onClick={onClick}\r\n    className={`p-1.5 rounded-lg hover:bg-slate-100 transition-colors focus:outline-none focus:ring-2 focus:ring-slate-200 ${className}`}\r\n  >\r\n    {children}\r\n  </button>\r\n);\r\n\r\n/* ============================\r\n   Portrait Employee Card\r\n   - tall card: height > width\r\n   ============================ */\r\ntype EmployeeCardProps = {\r\n  person: Person;\r\n  onOpenDetails: (p: Person) => void;\r\n  onMessage: (p: Person) => void;\r\n};\r\n\r\nconst EmployeeCard = React.forwardRef<HTMLButtonElement, EmployeeCardProps>(\r\n  ({ person, onOpenDetails, onMessage }, ref) => {\r\n    const isOnline = person.presence === \"online\";\r\n\r\n    return (\r\n      <motion.button\r\n        ref={ref}\r\n        type=\"button\"\r\n        onClick={() => onOpenDetails(person)}\r\n        whileHover={{ y: -2, boxShadow: \"0 10px 25px rgba(15,23,42,0.12)\" }}\r\n        transition={{ type: \"spring\", stiffness: 260, damping: 20 }}\r\n        className=\"w-full max-w-[230px] min-h-[280px] bg-white rounded-2xl border border-slate-200 shadow-sm flex flex-col items-stretch text-left focus:outline-none focus:ring-2 focus:ring-blue-500/40 hover:border-blue-300\"\r\n      >\r\n        {/* Top: avatar + name + role */}\r\n        <div className=\"flex flex-col items-center px-4 pt-4\">\r\n          <div\r\n            className={`w-14 h-14 rounded-full flex items-center justify-center text-lg font-medium ${\r\n              isOnline\r\n                ? \"bg-gradient-to-br from-emerald-500 to-teal-400 text-white\"\r\n                : \"bg-slate-100 text-slate-600\"\r\n            }`}\r\n          >\r\n            {person.name?.[0] ?? \"U\"}\r\n          </div>\r\n\r\n          <div className=\"mt-3 text-center\">\r\n            <div className=\"text-sm font-semibold text-slate-900 truncate max-w-[200px]\">\r\n              {person.name}\r\n            </div>\r\n            <div className=\"text-xs text-slate-500 truncate max-w-[200px] mt-0.5\">\r\n              {person.role}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Presence pill */}\r\n          <div className=\"mt-2\">\r\n            <span\r\n              className={`inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-[11px] font-medium ${\r\n                isOnline\r\n                  ? \"bg-emerald-50 text-emerald-700 border border-emerald-100\"\r\n                  : \"bg-slate-50 text-slate-500 border border-slate-100\"\r\n              }`}\r\n            >\r\n              <span\r\n                className={`w-1.5 h-1.5 rounded-full ${\r\n                  isOnline\r\n                    ? \"bg-emerald-500\"\r\n                    : person.presence === \"away\"\r\n                    ? \"bg-amber-400\"\r\n                    : \"bg-slate-400\"\r\n                }`}\r\n              />\r\n              <span className=\"capitalize\">{person.presence}</span>\r\n            </span>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Middle: small info */}\r\n        <div className=\"flex-1 px-4 pt-3 pb-2 text-xs text-slate-600 space-y-1.5\">\r\n          <div className=\"flex items-center gap-2 truncate\">\r\n            <MailIcon className=\"w-3 h-3 text-slate-400 shrink-0\" />\r\n            <span className=\"truncate\">{person.email ?? \"No email\"}</span>\r\n          </div>\r\n          {person.location && (\r\n            <div className=\"flex items-center gap-2 truncate\">\r\n              <Globe className=\"w-3 h-3 text-slate-400 shrink-0\" />\r\n              <span className=\"truncate\">{person.location}</span>\r\n            </div>\r\n          )}\r\n          {typeof person.tasksAssigned === \"number\" && (\r\n            <div className=\"flex items-center gap-2 truncate\">\r\n              <UserCheck className=\"w-3 h-3 text-slate-400 shrink-0\" />\r\n              <span>{person.tasksAssigned} tasks assigned</span>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Footer: actions */}\r\n        <div className=\"px-4 pb-4 pt-2 mt-auto flex items-center gap-2\">\r\n          <button\r\n            type=\"button\"\r\n            onClick={(e) => {\r\n              e.stopPropagation();\r\n              onOpenDetails(person);\r\n            }}\r\n            className=\"flex-1 px-2 py-1.5 rounded-lg bg-slate-50 hover:bg-slate-100 text-[11px] font-medium text-slate-700\"\r\n          >\r\n            View details\r\n          </button>\r\n\r\n          <button\r\n            type=\"button\"\r\n            onClick={(e) => {\r\n              e.stopPropagation();\r\n              onMessage(person);\r\n            }}\r\n            className=\"p-1.5 rounded-lg bg-blue-600 hover:bg-blue-700 text-white\"\r\n            aria-label={`Message ${person.name}`}\r\n          >\r\n            <MailIcon className=\"w-3.5 h-3.5\" />\r\n          </button>\r\n        </div>\r\n      </motion.button>\r\n    );\r\n  }\r\n);\r\n\r\nEmployeeCard.displayName = \"EmployeeCard\";\r\n\r\n/* ============================\r\n   Person Modal (details + actions)\r\n   ============================ */\r\nconst PersonModal: React.FC<{\r\n  person: Person | null;\r\n  open: boolean;\r\n  onClose: () => void;\r\n  onMessageClick: (person: Person) => void;\r\n  initialFocusRef?: React.RefObject<HTMLButtonElement | null>;\r\n}> = ({ person, open, onClose, onMessageClick, initialFocusRef }) => {\r\n  const closeButtonRef = useRef<HTMLButtonElement | null>(null);\r\n\r\n  useEffect(() => {\r\n    if (!open) return;\r\n    const onKey = (e: KeyboardEvent) => {\r\n      if (e.key === \"Escape\") onClose();\r\n    };\r\n    document.addEventListener(\"keydown\", onKey);\r\n    return () => document.removeEventListener(\"keydown\", onKey);\r\n  }, [open, onClose]);\r\n\r\n  useEffect(() => {\r\n    if (open) {\r\n      const t = setTimeout(\r\n        () => closeButtonRef.current?.focus(),\r\n        60\r\n      );\r\n      return () => clearTimeout(t);\r\n    }\r\n    if (initialFocusRef?.current) {\r\n      try {\r\n        initialFocusRef.current.focus();\r\n      } catch {\r\n        /* ignore */\r\n      }\r\n    }\r\n  }, [open, initialFocusRef]);\r\n\r\n  if (!person) return null;\r\n\r\n  return (\r\n    <AnimatePresence>\r\n      {open && (\r\n        <Modal\r\n          onClose={onClose}\r\n          ariaLabel={`Details for ${person.name}`}\r\n        >\r\n          <motion.div\r\n            initial={{ opacity: 0, y: 8 }}\r\n            animate={{ opacity: 1, y: 0 }}\r\n            exit={{ opacity: 0, y: 8 }}\r\n            transition={{ duration: 0.18 }}\r\n            className=\"max-w-2xl w-full bg-white rounded-2xl shadow-xl overflow-hidden\"\r\n          >\r\n            <div className=\"flex items-center justify-between p-4 border-b border-slate-100\">\r\n              <div className=\"flex items-center gap-3\">\r\n                <div\r\n                  className={`w-12 h-12 rounded-full flex items-center justify-center ${\r\n                    person.presence === \"online\"\r\n                      ? \"bg-gradient-to-br from-emerald-500 to-teal-400\"\r\n                      : \"bg-slate-100\"\r\n                  }`}\r\n                >\r\n                  <UserIcon\r\n                    className={`w-6 h-6 ${\r\n                      person.presence === \"online\"\r\n                        ? \"text-white\"\r\n                        : \"text-slate-500\"\r\n                    }`}\r\n                  />\r\n                </div>\r\n\r\n                <div>\r\n                  <div className=\"text-lg font-semibold text-slate-900\">\r\n                    {person.name}\r\n                  </div>\r\n                  <div className=\"text-sm text-slate-500\">\r\n                    {person.role}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"flex items-center gap-2\">\r\n                <IconButton\r\n                  ariaLabel=\"Close details\"\r\n                  title=\"Close\"\r\n                  onClick={onClose}\r\n                  className=\"bg-slate-50\"\r\n                >\r\n                  <XIcon className=\"w-4 h-4\" />\r\n                </IconButton>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"p-6 grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n              <div className=\"space-y-4\">\r\n                <div>\r\n                  <div className=\"text-xs text-slate-500\">\r\n                    Contact\r\n                  </div>\r\n                  <div className=\"mt-1 text-sm text-slate-800\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <MailIcon className=\"w-4 h-4 text-slate-400\" />\r\n                      <span>{person.email ?? \"—\"}</span>\r\n                    </div>\r\n                    <div className=\"mt-2 flex items-center gap-2\">\r\n                      <PhoneIcon className=\"w-4 h-4 text-slate-400\" />\r\n                      <span>{person.phone ?? \"—\"}</span>\r\n                    </div>\r\n                    <div className=\"mt-2 flex items-center gap-2\">\r\n                      <Globe className=\"w-4 h-4 text-slate-400\" />\r\n                      <span>{person.location ?? \"—\"}</span>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                <div>\r\n                  <div className=\"text-xs text-slate-500\">\r\n                    Work\r\n                  </div>\r\n                  <div className=\"mt-1 text-sm text-slate-800\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <Users className=\"w-4 h-4 text-slate-400\" />\r\n                      <span>{person.role}</span>\r\n                    </div>\r\n                    <div className=\"mt-2 flex items-center gap-2\">\r\n                      <Calendar className=\"w-4 h-4 text-slate-400\" />\r\n                      <span>Hired: {person.hiredAt ?? \"—\"}</span>\r\n                    </div>\r\n                    <div className=\"mt-2 flex items-center gap-2\">\r\n                      <UserCheck className=\"w-4 h-4 text-slate-400\" />\r\n                      <span>\r\n                        {person.tasksAssigned ?? 0} tasks assigned\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"space-y-4\">\r\n                <div>\r\n                  <div className=\"text-xs text-slate-500\">\r\n                    Activity & metrics\r\n                  </div>\r\n                  <div className=\"mt-1 text-sm text-slate-800 space-y-2\">\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <div className=\"text-sm text-slate-600\">\r\n                        Response rate\r\n                      </div>\r\n                      <div className=\"font-medium\">\r\n                        {person.respondRate ?? 0}%\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <div className=\"text-sm text-slate-600\">\r\n                        Presence\r\n                      </div>\r\n                      <div className=\"font-medium capitalize\">\r\n                        {person.presence}\r\n                      </div>\r\n                    </div>\r\n                    {person.label && (\r\n                      <div className=\"flex items-center justify-between\">\r\n                        <div className=\"text-sm text-slate-600\">\r\n                          Tag\r\n                        </div>\r\n                        <div\r\n                          className={`px-2 py-0.5 rounded-md text-xs font-medium ${person.label.colorClass}`}\r\n                        >\r\n                          {person.label.text}\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n\r\n                <div>\r\n                  <div className=\"text-xs text-slate-500\">\r\n                    Actions\r\n                  </div>\r\n                  <div className=\"mt-2 flex items-center gap-2\">\r\n                    <button\r\n                      type=\"button\"\r\n                      onClick={() => onMessageClick(person)}\r\n                      className=\"px-3 py-2 rounded-lg bg-slate-100 text-sm flex items-center gap-2 hover:bg-slate-200\"\r\n                    >\r\n                      <MailIcon className=\"w-4 h-4\" />\r\n                      Message\r\n                    </button>\r\n\r\n                    <button\r\n                      type=\"button\"\r\n                      onClick={() =>\r\n                        console.log(\"Call\", person.id)\r\n                      }\r\n                      className=\"px-3 py-2 rounded-lg bg-slate-100 text-sm flex items-center gap-2 hover:bg-slate-200\"\r\n                    >\r\n                      <PhoneIcon className=\"w-4 h-4\" />\r\n                      Call\r\n                    </button>\r\n\r\n                    <button\r\n                      type=\"button\"\r\n                      onClick={() =>\r\n                        console.log(\"More actions\", person.id)\r\n                      }\r\n                      className=\"p-2 rounded-lg bg-slate-50 hover:bg-slate-100\"\r\n                      aria-label=\"More\"\r\n                    >\r\n                      <MoreVertical className=\"w-4 h-4\" />\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"p-4 border-t border-slate-100 text-right\">\r\n              <button\r\n                ref={closeButtonRef}\r\n                type=\"button\"\r\n                onClick={onClose}\r\n                className=\"px-4 py-2 rounded-lg bg-gradient-to-br from-blue-500 to-cyan-500 text-white font-medium hover:opacity-95\"\r\n              >\r\n                Close\r\n              </button>\r\n            </div>\r\n          </motion.div>\r\n        </Modal>\r\n      )}\r\n    </AnimatePresence>\r\n  );\r\n};\r\n\r\n/* ============================\r\n   Message Modal: opens a TeamChat for a direct chat\r\n   ============================ */\r\nconst MessageModal: React.FC<{\r\n  open: boolean;\r\n  onClose: () => void;\r\n  memberId: string | null;\r\n  memberName?: string | null;\r\n  currentUser: { id: string; name?: string } | null;\r\n}> = ({\r\n  open,\r\n  onClose,\r\n  memberId,\r\n  memberName,\r\n  currentUser,\r\n}) => {\r\n  const [chatId, setChatId] = useState<string | null>(null);\r\n  const [loading, setLoading] = useState(false);\r\n  const [errorText, setErrorText] = useState<string | null>(\r\n    null\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (!open) {\r\n      setChatId(null);\r\n      setErrorText(null);\r\n      return;\r\n    }\r\n    if (!memberId) return;\r\n\r\n    let cancelled = false;\r\n\r\n    const ensureChat = async () => {\r\n      setLoading(true);\r\n      setErrorText(null);\r\n\r\n      try {\r\n        const meId = currentUser?.id\r\n          ? String(currentUser.id)\r\n          : null;\r\n\r\n        // 1) try to find an existing direct chat involving this member (and me if known)\r\n        try {\r\n          const qRes = await fetch(`/api/chats`, {\r\n            credentials: \"same-origin\",\r\n          });\r\n          if (!cancelled && qRes.ok) {\r\n            const j = await qRes.json().catch(() => ({}));\r\n            const list: any[] =\r\n              j?.chats ?? j?.items ?? j ?? [];\r\n\r\n            const found =\r\n              list.find((c) => {\r\n                if (!c) return false;\r\n\r\n                const t = (\r\n                  c.type ?? c.chatType ?? \"\"\r\n                )\r\n                  .toString()\r\n                  .toLowerCase();\r\n                const isDirectType =\r\n                  t.includes(\"direct\") ||\r\n                  t.includes(\"dm\") ||\r\n                  t.includes(\"one_to_one\") ||\r\n                  t.includes(\"private\");\r\n\r\n                const rawMembers =\r\n                  c.members ??\r\n                  c.participants ??\r\n                  c.users ??\r\n                  c.userIds ??\r\n                  c.memberIds ??\r\n                  c.participantIds ??\r\n                  [];\r\n\r\n                if (!Array.isArray(rawMembers))\r\n                  return false;\r\n\r\n                const ids = rawMembers\r\n                  .map((m: any) => {\r\n                    if (\r\n                      m === null ||\r\n                      m === undefined\r\n                    )\r\n                      return null;\r\n                    if (\r\n                      typeof m === \"string\" ||\r\n                      typeof m === \"number\"\r\n                    ) {\r\n                      return String(m);\r\n                    }\r\n                    // object: try common shapes\r\n                    return (\r\n                      (m.userId ??\r\n                        m.id ??\r\n                        m._id ??\r\n                        m.user?.id ??\r\n                        m.user?._id ??\r\n                        null) &&\r\n                      String(\r\n                        m.userId ??\r\n                          m.id ??\r\n                          m._id ??\r\n                          m.user?.id ??\r\n                          m.user?._id\r\n                      )\r\n                    );\r\n                  })\r\n                  .filter(Boolean) as string[];\r\n\r\n                const targetId = String(memberId);\r\n                const hasMember = ids.includes(targetId);\r\n                const hasMe =\r\n                  meId ? ids.includes(meId) : true;\r\n\r\n                // prefer 1:1-ish conversations\r\n                const isOneToOne = ids.length <= 2;\r\n\r\n                return (\r\n                  hasMember &&\r\n                  hasMe &&\r\n                  (isDirectType || isOneToOne)\r\n                );\r\n              }) ?? null;\r\n\r\n            if (found) {\r\n              const id =\r\n                found.id ??\r\n                found.chatId ??\r\n                found._id ??\r\n                null;\r\n              if (id && !cancelled) {\r\n                setChatId(String(id));\r\n                setLoading(false);\r\n                return;\r\n              }\r\n            }\r\n          }\r\n        } catch (e) {\r\n          console.warn(\"chat list check failed:\", e);\r\n        }\r\n\r\n        // 2) Try several possible payload shapes to create a new direct chat\r\n        const attempts = [\r\n          {\r\n            body: {\r\n              type: \"direct\",\r\n              memberId,\r\n              userIds: meId ? [meId, memberId] : [memberId],\r\n            },\r\n            label: \"type:direct + memberId + userIds\",\r\n          },\r\n          {\r\n            body: {\r\n              type: \"direct\",\r\n              userId: memberId,\r\n              userIds: meId ? [meId, memberId] : [memberId],\r\n            },\r\n            label: \"type:direct + userId + userIds\",\r\n          },\r\n          {\r\n            body: {\r\n              type: \"direct\",\r\n              userIds: meId ? [meId, memberId] : [memberId],\r\n            },\r\n            label: \"type:direct + userIds\",\r\n          },\r\n          {\r\n            body: {\r\n              userIds: meId ? [meId, memberId] : [memberId],\r\n            },\r\n            label: \"userIds: [me, member]\",\r\n          },\r\n          {\r\n            body: {\r\n              memberIds: meId ? [meId, memberId] : [memberId],\r\n            },\r\n            label: \"memberIds: [me, member]\",\r\n          },\r\n          {\r\n            body: {\r\n              participantIds: meId\r\n                ? [meId, memberId]\r\n                : [memberId],\r\n            },\r\n            label: \"participantIds: [me, member]\",\r\n          },\r\n          {\r\n            body: { directTo: memberId },\r\n            label: \"directTo: memberId\",\r\n          },\r\n        ];\r\n\r\n        for (const a of attempts) {\r\n          if (cancelled) return;\r\n\r\n          try {\r\n            const res = await fetch(\"/api/chats\", {\r\n              method: \"POST\",\r\n              credentials: \"same-origin\",\r\n              headers: {\r\n                \"Content-Type\": \"application/json\",\r\n              },\r\n              body: JSON.stringify(a.body),\r\n            });\r\n\r\n            if (cancelled) return;\r\n\r\n            if (res.ok) {\r\n              const j = await res\r\n                .json()\r\n                .catch(() => ({}));\r\n              const created =\r\n                j?.chat ?? j?.message ?? j ?? {};\r\n              const id =\r\n                created.id ??\r\n                created.chatId ??\r\n                created._id ??\r\n                null;\r\n              if (id) {\r\n                setChatId(String(id));\r\n                setLoading(false);\r\n                return;\r\n              }\r\n            } else {\r\n              const txt = await res\r\n                .text()\r\n                .catch(() => \"\");\r\n              console.warn(\r\n                `[create chat attempt \"${a.label}\" returned ${res.status}]`,\r\n                txt\r\n              );\r\n              setErrorText(\r\n                `Attempt \"${a.label}\" → ${res.status}: ${txt}`\r\n              );\r\n            }\r\n          } catch (e: any) {\r\n            console.warn(\r\n              `create attempt \"${a.label}\" failed:`,\r\n              e\r\n            );\r\n            setErrorText(\r\n              `Attempt \"${a.label}\" failed: ${String(\r\n                e?.message ?? e\r\n              )}`\r\n            );\r\n          }\r\n        }\r\n\r\n        if (!cancelled) {\r\n          setChatId(null);\r\n        }\r\n      } finally {\r\n        if (!cancelled) setLoading(false);\r\n      }\r\n    };\r\n\r\n    void ensureChat();\r\n\r\n    return () => {\r\n      cancelled = true;\r\n    };\r\n  }, [open, memberId, currentUser]);\r\n\r\n  return (\r\n    <AnimatePresence>\r\n      {open && (\r\n        <Modal\r\n          onClose={onClose}\r\n          ariaLabel={`Chat with ${memberName ?? \"member\"}`}\r\n        >\r\n          <motion.div\r\n            initial={{ opacity: 0, y: 8 }}\r\n            animate={{ opacity: 1, y: 0 }}\r\n            exit={{ opacity: 0, y: 8 }}\r\n            transition={{ duration: 0.14 }}\r\n            className=\"max-w-3xl w-full bg-white rounded-2xl shadow-xl overflow-hidden\"\r\n          >\r\n            <div className=\"flex items-center justify-between p-3 border-b border-slate-100\">\r\n              <div className=\"flex items-center gap-3\">\r\n                <div className=\"w-10 h-10 rounded-md bg-slate-100 flex items-center justify-center\">\r\n                  <UserIcon className=\"w-5 h-5 text-slate-600\" />\r\n                </div>\r\n                <div>\r\n                  <div className=\"text-sm font-medium text-slate-900\">\r\n                    Chat with {memberName ?? \"member\"}\r\n                  </div>\r\n                  <div className=\"text-xs text-slate-500\">\r\n                    {chatId\r\n                      ? `Chat: ${chatId}`\r\n                      : loading\r\n                      ? \"Preparing chat…\"\r\n                      : errorText\r\n                      ? \"Could not create chat\"\r\n                      : \"Preparing chat…\"}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"flex items-center gap-2\">\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={onClose}\r\n                  className=\"px-3 py-1 rounded-md bg-slate-50 hover:bg-slate-100\"\r\n                >\r\n                  Close\r\n                </button>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"p-4 min-h-[320px]\">\r\n              {loading ? (\r\n                <div className=\"text-sm text-slate-500\">\r\n                  Preparing chat…\r\n                </div>\r\n              ) : chatId ? (\r\n                // render TeamChat for this chatId\r\n                // @ts-ignore (dynamic import client-only)\r\n                <div className=\"h-[60vh]\">\r\n                  <TeamChat\r\n                    chatId={chatId}\r\n                    currentUser={\r\n                      currentUser\r\n                        ? {\r\n                            id: currentUser.id,\r\n                            name: currentUser.name,\r\n                          }\r\n                        : { id: \"me\" }\r\n                    }\r\n                  />\r\n                </div>\r\n              ) : (\r\n                <div className=\"text-sm text-rose-600\">\r\n                  Couldn't create chat automatically. Please\r\n                  try again or contact your administrator.\r\n                  {errorText && (\r\n                    <div className=\"mt-2 text-xs text-slate-500 break-words max-h-32 overflow-auto border-t pt-2\">\r\n                      {errorText}\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              )}\r\n            </div>\r\n          </motion.div>\r\n        </Modal>\r\n      )}\r\n    </AnimatePresence>\r\n  );\r\n};\r\n\r\n/* ============================\r\n   Main People Page\r\n   ============================ */\r\nexport default function ManagerPeoplePage(): JSX.Element {\r\n  const [searchQuery, setSearchQuery] = useState(\"\");\r\n  const [filter, setFilter] = useState<\r\n    \"all\" | \"online\" | \"offline\" | \"role\"\r\n  >(\"all\");\r\n  const [team, setTeam] = useState<string>(\"Growth Team\");\r\n\r\n  const [people, setPeople] = useState<Person[]>([]);\r\n  const [loading, setLoading] = useState<boolean>(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  const [selectedPerson, setSelectedPerson] =\r\n    useState<Person | null>(null);\r\n  const [isModalOpen, setIsModalOpen] =\r\n    useState(false);\r\n  const lastTriggerRef =\r\n    useRef<HTMLButtonElement | null>(null);\r\n\r\n  // message modal state\r\n  const [messageModalOpen, setMessageModalOpen] =\r\n    useState(false);\r\n  const [messageTargetId, setMessageTargetId] =\r\n    useState<string | null>(null);\r\n  const [messageTargetName, setMessageTargetName] =\r\n    useState<string | null>(null);\r\n\r\n  const router = useRouter();\r\n\r\n  // fetch current user (manager) to pass to TeamChat\r\n  const [me, setMe] = useState<{ id: string; name?: string } | null>(\r\n    null\r\n  );\r\n  useEffect(() => {\r\n    (async () => {\r\n      try {\r\n        const r = await fetch(\"/api/me\", {\r\n          credentials: \"same-origin\",\r\n        });\r\n        if (!r.ok) return;\r\n        const j = await r.json().catch(() => ({}));\r\n        const user = j?.user ?? j ?? null;\r\n        if (user?.id)\r\n          setMe({\r\n            id: String(user.id),\r\n            name: user.name ?? undefined,\r\n          });\r\n      } catch {\r\n        // ignore\r\n      }\r\n    })();\r\n  }, []);\r\n\r\n  // load teams -> pick team by name -> fetch members\r\n  useEffect(() => {\r\n    let cancelled = false;\r\n\r\n    const load = async () => {\r\n      setLoading(true);\r\n      setError(null);\r\n      try {\r\n        // 1) fetch teams list\r\n        const res = await fetch(\"/api/teams\", {\r\n          credentials: \"same-origin\",\r\n        });\r\n        if (!res.ok)\r\n          throw new Error(`teams fetch failed ${res.status}`);\r\n        const j = await res.json().catch(() => ({}));\r\n        const list: any[] =\r\n          j?.teams ?? j?.items ?? j ?? [];\r\n\r\n        // 2) find team by name (fallback to first)\r\n        const foundTeam =\r\n          list.find(\r\n            (t: any) =>\r\n              String(t.name || \"\").toLowerCase() ===\r\n              team.toLowerCase()\r\n          ) ?? list[0] ?? null;\r\n        if (!foundTeam) {\r\n          if (!cancelled) setPeople([]);\r\n          return;\r\n        }\r\n\r\n        const teamId =\r\n          foundTeam.id ??\r\n          foundTeam.teamId ??\r\n          foundTeam._id ??\r\n          null;\r\n        if (!teamId) {\r\n          if (!cancelled) setPeople([]);\r\n          return;\r\n        }\r\n\r\n        // 3) fetch team details\r\n        const detailRes = await fetch(\r\n          `/api/teams/${encodeURIComponent(teamId)}`,\r\n          { credentials: \"same-origin\" }\r\n        );\r\n        if (!detailRes.ok) {\r\n          const errText = await detailRes\r\n            .text()\r\n            .catch(() => \"\");\r\n          throw new Error(\r\n            `team detail failed ${detailRes.status} ${errText}`\r\n          );\r\n        }\r\n        const dj = await detailRes\r\n          .json()\r\n          .catch(() => ({}));\r\n        const teamObj = dj?.team ?? dj ?? {};\r\n\r\n        // 4) map members to Person[]\r\n        const members = (teamObj.members ?? []).map(\r\n          (m: any) => {\r\n            const id =\r\n              m.userId ?? m.user?.id ?? m.id ?? null;\r\n            const name =\r\n              m.name ??\r\n              m.user?.name ??\r\n              (m.user ? `${m.user.name}` : null) ??\r\n              (id ? `User ${id}` : \"Unknown\");\r\n            return {\r\n              id: String(id ?? \"\"),\r\n              name: name ?? \"Unknown\",\r\n              role: (m.role ?? m.user?.role ?? \"Employee\") as Role,\r\n              presence: \"offline\" as Presence,\r\n              email:\r\n                m.email ?? m.user?.email ?? null,\r\n              phone: null,\r\n              location: null,\r\n              tasksAssigned: 0,\r\n              respondRate: 0,\r\n              hiredAt: null,\r\n              starred: false,\r\n              label: null,\r\n            } as Person;\r\n          }\r\n        );\r\n\r\n        if (!cancelled) setPeople(members);\r\n      } catch (err: any) {\r\n        console.warn(\"Failed to load people:\", err);\r\n        if (!cancelled)\r\n          setError(\"Failed to load team members\");\r\n      } finally {\r\n        if (!cancelled) setLoading(false);\r\n      }\r\n    };\r\n\r\n    void load();\r\n    return () => {\r\n      cancelled = true;\r\n    };\r\n  }, [team]);\r\n\r\n  // click handlers\r\n  const openPersonModal = (\r\n    person: Person,\r\n    triggerRef?: React.RefObject<HTMLButtonElement>\r\n  ) => {\r\n    setSelectedPerson(person);\r\n    setIsModalOpen(true);\r\n    if (triggerRef?.current)\r\n      lastTriggerRef.current = triggerRef.current;\r\n  };\r\n\r\n  const closePersonModal = () => {\r\n    setIsModalOpen(false);\r\n    setSelectedPerson(null);\r\n  };\r\n\r\n  const handleMessageClick = (person: Person) => {\r\n    setMessageTargetId(person.id);\r\n    setMessageTargetName(person.name);\r\n    setMessageModalOpen(true);\r\n  };\r\n\r\n  // search + filter\r\n  const filtered = useMemo(() => {\r\n    const q = searchQuery.trim().toLowerCase();\r\n    return people.filter((p) => {\r\n      const matchesSearch =\r\n        q === \"\" ||\r\n        p.name.toLowerCase().includes(q) ||\r\n        (p.email ?? \"\")\r\n          .toLowerCase()\r\n          .includes(q) ||\r\n        String(p.role ?? \"\")\r\n          .toLowerCase()\r\n          .includes(q);\r\n      const matchesFilter =\r\n        filter === \"all\" ||\r\n        (filter === \"online\" &&\r\n          p.presence === \"online\") ||\r\n        (filter === \"offline\" &&\r\n          p.presence === \"offline\") ||\r\n        (filter === \"role\" &&\r\n          p.role === \"Team Lead\");\r\n      return matchesSearch && matchesFilter;\r\n    });\r\n  }, [people, searchQuery, filter]);\r\n\r\n  const onlineCount = people.filter(\r\n    (p) => p.presence === \"online\"\r\n  ).length;\r\n  const totalCount = people.length;\r\n  const avgResponse =\r\n    Math.round(\r\n      (people.reduce(\r\n        (s, p) => s + (p.respondRate ?? 0),\r\n        0\r\n      ) /\r\n        (people.length || 1)) *\r\n        1\r\n    ) / 1;\r\n\r\n  // refs per person card to restore focus\r\n  const cardRefs =\r\n    useRef<\r\n      Map<string, React.RefObject<HTMLButtonElement>>\r\n    >(new Map());\r\n  people.forEach((p) => {\r\n    if (!cardRefs.current.has(p.id))\r\n      cardRefs.current.set(\r\n        p.id,\r\n        React.createRef<HTMLButtonElement>()\r\n      );\r\n  });\r\n\r\n  return (\r\n    <main className=\"min-h-screen bg-gradient-to-br from-slate-50 via-white to-slate-50 p-4 sm:p-6 lg:p-8\">\r\n      <div className=\"max-w-6xl mx-auto\">\r\n        {/* header */}\r\n        <header className=\"mb-6\">\r\n          <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3\">\r\n            <div className=\"flex items-center gap-3\">\r\n              <h1 className=\"text-2xl sm:text-3xl md:text-4xl font-bold bg-gradient-to-r from-slate-800 to-slate-600 bg-clip-text text-transparent\">\r\n                People\r\n              </h1>\r\n\r\n              {onlineCount > 0 && (\r\n                <motion.div\r\n                  initial={{ scale: 0 }}\r\n                  animate={{ scale: 1 }}\r\n                  className=\"px-3 py-1 bg-gradient-to-br from-blue-500 to-cyan-500 text-white text-sm font-bold rounded-full shadow-lg\"\r\n                >\r\n                  {onlineCount}\r\n                </motion.div>\r\n              )}\r\n            </div>\r\n\r\n            <div className=\"flex items-center gap-4\">\r\n              <div className=\"flex items-center gap-2 text-sm text-slate-500\">\r\n                <Users className=\"w-4 h-4\" />\r\n                <span>{team}</span>\r\n              </div>\r\n\r\n              <div className=\"flex items-center gap-2 text-sm text-slate-500\">\r\n                <CheckCircle2 className=\"w-4 h-4\" />\r\n                <span>{avgResponse}% avg response</span>\r\n              </div>\r\n\r\n              <div className=\"flex items-center gap-2 text-sm text-slate-500\">\r\n                <UserPlus className=\"w-4 h-4\" />\r\n                <span>{totalCount} members</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <p className=\"text-sm text-slate-500 mt-2\">\r\n            Browse and message members of your team.\r\n            Click a card to view details or message\r\n            directly.\r\n          </p>\r\n        </header>\r\n\r\n        {/* container */}\r\n        <section className=\"bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden\">\r\n          {/* controls */}\r\n          <div className=\"p-4 sm:p-6 border-b border-slate-200\">\r\n            <div className=\"flex flex-col sm:flex-row sm:items-center gap-3\">\r\n              <div className=\"relative flex-1 min-w-[160px]\">\r\n                <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400\" />\r\n                <input\r\n                  type=\"search\"\r\n                  aria-label=\"Search people\"\r\n                  placeholder=\"Search people, email, role...\"\r\n                  value={searchQuery}\r\n                  onChange={(e) =>\r\n                    setSearchQuery(e.target.value)\r\n                  }\r\n                  className=\"w-full pl-10 pr-4 py-2.5 bg-slate-50 border border-slate-200 rounded-xl text-sm placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 focus:bg-white transition-all duration-150\"\r\n                />\r\n              </div>\r\n\r\n              <div className=\"flex items-center gap-2\">\r\n                <div className=\"flex items-center gap-2 overflow-x-auto\">\r\n                  <button\r\n                    onClick={() => setFilter(\"all\")}\r\n                    type=\"button\"\r\n                    className={`px-3 py-2 rounded-xl text-sm ${\r\n                      filter === \"all\"\r\n                        ? \"bg-gradient-to-br from-blue-500 to-cyan-500 text-white\"\r\n                        : \"bg-slate-50 text-slate-600 hover:bg-slate-100\"\r\n                    }`}\r\n                  >\r\n                    All\r\n                  </button>\r\n                  <button\r\n                    onClick={() => setFilter(\"online\")}\r\n                    type=\"button\"\r\n                    className={`px-3 py-2 rounded-xl text-sm ${\r\n                      filter === \"online\"\r\n                        ? \"bg-gradient-to-br from-blue-500 to-cyan-500 text-white\"\r\n                        : \"bg-slate-50 text-slate-600 hover:bg-slate-100\"\r\n                    }`}\r\n                  >\r\n                    Online\r\n                  </button>\r\n                  <button\r\n                    onClick={() => setFilter(\"offline\")}\r\n                    type=\"button\"\r\n                    className={`px-3 py-2 rounded-xl text-sm ${\r\n                      filter === \"offline\"\r\n                        ? \"bg-gradient-to-br from-blue-500 to-cyan-500 text-white\"\r\n                        : \"bg-slate-50 text-slate-600 hover:bg-slate-100\"\r\n                    }`}\r\n                  >\r\n                    Offline\r\n                  </button>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"ml-auto flex items-center gap-2\">\r\n                <label\r\n                  className=\"sr-only\"\r\n                  htmlFor=\"team-select-people\"\r\n                >\r\n                  Choose team\r\n                </label>\r\n                <select\r\n                  id=\"team-select-people\"\r\n                  value={team}\r\n                  onChange={(e) =>\r\n                    setTeam(e.target.value)\r\n                  }\r\n                  className=\"px-3 py-2 bg-slate-50 border border-slate-200 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-blue-500/20\"\r\n                >\r\n                  <option>Growth Team</option>\r\n                  <option>Support Team</option>\r\n                  <option>Product Team</option>\r\n                </select>\r\n\r\n                <button\r\n                  type=\"button\"\r\n                  className=\"px-4 py-2 rounded-xl bg-gradient-to-br from-blue-500 to-cyan-500 text-white font-medium text-sm shadow-lg hover:opacity-95\"\r\n                  onClick={() => {\r\n                    console.log(\"Invite new member\");\r\n                    router.push(\"/auth/invite\"); // kept as-is\r\n                  }}\r\n                >\r\n                  Invite\r\n                </button>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"mt-4 flex flex-col sm:flex-row sm:items-center sm:gap-6 gap-3 text-sm text-slate-600\">\r\n              <span className=\"flex items-center gap-2\">\r\n                <Users className=\"w-4 h-4\" />\r\n                {people.length} total\r\n              </span>\r\n              <span className=\"flex items-center gap-2\">\r\n                <UserCheck className=\"w-4 h-4 text-blue-500\" />\r\n                {onlineCount} online\r\n              </span>\r\n            </div>\r\n          </div>\r\n\r\n          {/* grid of tall cards */}\r\n          <div className=\"p-4 sm:p-6\">\r\n            {loading ? (\r\n              <div className=\"py-10 text-center text-sm text-slate-500\">\r\n                Loading members…\r\n              </div>\r\n            ) : error ? (\r\n              <div className=\"py-10 text-center text-sm text-rose-600\">\r\n                {error}\r\n              </div>\r\n            ) : filtered.length > 0 ? (\r\n              <div className=\"grid grid-cols-2 md:grid-cols-3 gap-4 justify-items-center\">\r\n                {filtered.map((person) => {\r\n                  const ref =\r\n                    cardRefs.current.get(person.id) ??\r\n                    React.createRef<HTMLButtonElement>();\r\n                  cardRefs.current.set(person.id, ref);\r\n\r\n                  return (\r\n                    <EmployeeCard\r\n                      key={person.id}\r\n                      ref={ref}\r\n                      person={person}\r\n                      onOpenDetails={(p) =>\r\n                        openPersonModal(p, ref)\r\n                      }\r\n                      onMessage={handleMessageClick}\r\n                    />\r\n                  );\r\n                })}\r\n              </div>\r\n            ) : (\r\n              <div className=\"py-16 text-center\">\r\n                <div className=\"w-16 h-16 mx-auto mb-4 rounded-2xl bg-gradient-to-br from-slate-100 to-slate-200 flex items-center justify-center\">\r\n                  <Users className=\"w-8 h-8 text-slate-400\" />\r\n                </div>\r\n                <h3 className=\"text-lg font-semibold text-slate-800 mb-2\">\r\n                  No members found\r\n                </h3>\r\n                <p className=\"text-slate-500\">\r\n                  Try adjusting your search, filters, or team\r\n                  selection\r\n                </p>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </section>\r\n      </div>\r\n\r\n      {/* Person details modal */}\r\n      <PersonModal\r\n        person={selectedPerson}\r\n        open={isModalOpen}\r\n        onClose={closePersonModal}\r\n        onMessageClick={handleMessageClick}\r\n        initialFocusRef={lastTriggerRef}\r\n      />\r\n\r\n      {/* Message modal (TeamChat) */}\r\n      <MessageModal\r\n        open={messageModalOpen}\r\n        onClose={() => setMessageModalOpen(false)}\r\n        memberId={messageTargetId}\r\n        memberName={messageTargetName ?? undefined}\r\n        currentUser={me}\r\n      />\r\n    </main>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}