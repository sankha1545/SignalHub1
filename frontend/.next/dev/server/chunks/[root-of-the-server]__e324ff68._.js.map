{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///E:/Attack%20Capital/SignalHub/frontend/src/lib/prisma.ts"],"sourcesContent":["// lib/prisma.ts\r\nimport { PrismaClient } from \"@prisma/client\";\r\n\r\ndeclare global {\r\n  // eslint-disable-next-line\r\n  var __prisma__: PrismaClient | undefined;\r\n}\r\nexport const prisma =\r\n  global.__prisma__ ??\r\n  new PrismaClient({\r\n    log: process.env.NODE_ENV === \"development\" ? [\"query\", \"warn\", \"error\"] : [\"error\"],\r\n  });\r\n\r\nif (process.env.NODE_ENV !== \"production\") global.__prisma__ = prisma;\r\n"],"names":[],"mappings":"AAAA,gBAAgB;;;;;AAChB;;AAMO,MAAM,SACX,OAAO,UAAU,IACjB,IAAI,6IAAY,CAAC;IACf,KAAK,uCAAyC;QAAC;QAAS;QAAQ;KAAQ,GAAG;AAC7E;AAEF,wCAA2C,OAAO,UAAU,GAAG","debugId":null}},
    {"offset": {"line": 71, "column": 0}, "map": {"version":3,"sources":["file:///E:/Attack%20Capital/SignalHub/frontend/src/lib/rbac.ts"],"sourcesContent":["/**\r\n* src/lib/rbac.ts\r\n* Role-based helpers and small policy helpers used across routes.\r\n*/\r\nimport { prisma } from '@/lib/prisma';\r\nimport type { SessionUser } from './auth';\r\n\r\n\r\nexport function requireAuth(user: SessionUser | null) {\r\nif (!user) throw new Error('unauthenticated');\r\n}\r\n\r\n\r\nexport function requireRole(user: SessionUser | null, role: 'ADMIN' | 'MANAGER' | 'EMPLOYEE') {\r\nrequireAuth(user);\r\nif (user!.role !== role) throw new Error('forbidden');\r\n}\r\n\r\n\r\nexport async function isOrgAdmin(userId: string, orgId: string) {\r\nconst u = await prisma.user.findUnique({ where: { id: userId } });\r\nreturn !!u && u.organizationId === orgId && u.role === 'ADMIN';\r\n}\r\n\r\n\r\nexport async function isTeamManager(userId: string, teamId: string) {\r\nconst tm = await prisma.teamMember.findFirst({ where: { userId, teamId } });\r\nreturn !!tm && tm.role === 'MANAGER';\r\n}\r\n\r\n\r\nexport async function canViewTeam(userId: string, teamId: string) {\r\n// admin of org or member of team\r\nconst tm = await prisma.teamMember.findFirst({ where: { userId, teamId } });\r\nif (tm) return true;\r\nconst u = await prisma.user.findUnique({ where: { id: userId } });\r\nreturn !!u && u.role === 'ADMIN' && !!u.organizationId;\r\n}"],"names":[],"mappings":"AAAA;;;AAGA;;;;;;;;;;;;AACA;;AAIO,SAAS,YAAY,IAAwB;IACpD,IAAI,CAAC,MAAM,MAAM,IAAI,MAAM;AAC3B;AAGO,SAAS,YAAY,IAAwB,EAAE,IAAsC;IAC5F,YAAY;IACZ,IAAI,KAAM,IAAI,KAAK,MAAM,MAAM,IAAI,MAAM;AACzC;AAGO,eAAe,WAAW,MAAc,EAAE,KAAa;IAC9D,MAAM,IAAI,MAAM,gIAAM,CAAC,IAAI,CAAC,UAAU,CAAC;QAAE,OAAO;YAAE,IAAI;QAAO;IAAE;IAC/D,OAAO,CAAC,CAAC,KAAK,EAAE,cAAc,KAAK,SAAS,EAAE,IAAI,KAAK;AACvD;AAGO,eAAe,cAAc,MAAc,EAAE,MAAc;IAClE,MAAM,KAAK,MAAM,gIAAM,CAAC,UAAU,CAAC,SAAS,CAAC;QAAE,OAAO;YAAE;YAAQ;QAAO;IAAE;IACzE,OAAO,CAAC,CAAC,MAAM,GAAG,IAAI,KAAK;AAC3B;AAGO,eAAe,YAAY,MAAc,EAAE,MAAc;IAChE,iCAAiC;IACjC,MAAM,KAAK,MAAM,gIAAM,CAAC,UAAU,CAAC,SAAS,CAAC;QAAE,OAAO;YAAE;YAAQ;QAAO;IAAE;IACzE,IAAI,IAAI,OAAO;IACf,MAAM,IAAI,MAAM,gIAAM,CAAC,IAAI,CAAC,UAAU,CAAC;QAAE,OAAO;YAAE,IAAI;QAAO;IAAE;IAC/D,OAAO,CAAC,CAAC,KAAK,EAAE,IAAI,KAAK,WAAW,CAAC,CAAC,EAAE,cAAc;AACtD","debugId":null}},
    {"offset": {"line": 132, "column": 0}, "map": {"version":3,"sources":["file:///E:/Attack%20Capital/SignalHub/frontend/src/app/api/dashboard/unified-inbox/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\r\nimport { prisma } from \"@/lib/prisma\";\r\nimport { getUserFromRequest } from \"@/lib/rbac\";\r\n\r\nexport async function GET(req: Request) {\r\n  const user = await getUserFromRequest(req);\r\n\r\n  const messages = await prisma.message.findMany({\r\n    where: {\r\n      OR: [\r\n        { senderId: user.id },\r\n        { recipientId: user.id },\r\n      ],\r\n    },\r\n    include: { sender: true, recipient: true },\r\n    orderBy: { createdAt: \"desc\" },\r\n  });\r\n\r\n  return NextResponse.json({ ok: true, messages });\r\n}\r\n\r\nexport async function POST(req: Request) {\r\n  const user = await getUserFromRequest(req);\r\n  const { recipientId, content, channel } = await req.json();\r\n\r\n  const message = await prisma.message.create({\r\n    data: {\r\n      senderId: user.id,\r\n      recipientId,\r\n      content,\r\n      channel: channel || \"IN_APP\",\r\n    },\r\n  });\r\n\r\n  return NextResponse.json({ ok: true, message });\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;;;;AAEO,eAAe,IAAI,GAAY;IACpC,MAAM,OAAO,MAAM,IAAA,0IAAkB,EAAC;IAEtC,MAAM,WAAW,MAAM,gIAAM,CAAC,OAAO,CAAC,QAAQ,CAAC;QAC7C,OAAO;YACL,IAAI;gBACF;oBAAE,UAAU,KAAK,EAAE;gBAAC;gBACpB;oBAAE,aAAa,KAAK,EAAE;gBAAC;aACxB;QACH;QACA,SAAS;YAAE,QAAQ;YAAM,WAAW;QAAK;QACzC,SAAS;YAAE,WAAW;QAAO;IAC/B;IAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;QAAE,IAAI;QAAM;IAAS;AAChD;AAEO,eAAe,KAAK,GAAY;IACrC,MAAM,OAAO,MAAM,IAAA,0IAAkB,EAAC;IACtC,MAAM,EAAE,WAAW,EAAE,OAAO,EAAE,OAAO,EAAE,GAAG,MAAM,IAAI,IAAI;IAExD,MAAM,UAAU,MAAM,gIAAM,CAAC,OAAO,CAAC,MAAM,CAAC;QAC1C,MAAM;YACJ,UAAU,KAAK,EAAE;YACjB;YACA;YACA,SAAS,WAAW;QACtB;IACF;IAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;QAAE,IAAI;QAAM;IAAQ;AAC/C","debugId":null}}]
}