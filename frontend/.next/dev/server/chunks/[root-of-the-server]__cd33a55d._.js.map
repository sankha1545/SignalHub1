{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 70, "column": 0}, "map": {"version":3,"sources":["file:///E:/Attack%20Capital/SignalHub/frontend/src/lib/jwt.ts"],"sourcesContent":["// src/lib/jwt.ts\r\nimport jwt from \"jsonwebtoken\";\r\n\r\nconst SECRET = process.env.JWT_SECRET || \"dev_secret_fallback\";\r\n\r\n/**\r\n * üîê Create a short-lived token (e.g. phone/email verification)\r\n */\r\nexport function signTemp(payload: object, expiresIn: string = \"15m\") {\r\n  const safePayload = { ...payload };\r\n  delete (safePayload as any).exp; // prevent conflict with `exp` inside payload\r\n  return jwt.sign(safePayload, SECRET, { expiresIn });\r\n}\r\n\r\n/**\r\n * ‚úÖ Verify short-lived temp tokens\r\n */\r\nexport function verifyTemp(token: string) {\r\n  return jwt.verify(token, SECRET);\r\n}\r\n\r\n/**\r\n * üíæ Create a long-lived session token for logged-in users\r\n */\r\nexport function signSession(payload: object, expiresIn: string = \"7d\") {\r\n  const safePayload = { ...payload };\r\n  delete (safePayload as any).exp;\r\n  return jwt.sign(safePayload, SECRET, { expiresIn });\r\n}\r\n\r\n/**\r\n * üîé Verify a session token\r\n */\r\nexport function verifySession(token: string) {\r\n  return jwt.verify(token, SECRET);\r\n}\r\n"],"names":[],"mappings":"AAAA,iBAAiB;;;;;;;;;;;AACjB;;AAEA,MAAM,SAAS,QAAQ,GAAG,CAAC,UAAU,IAAI;AAKlC,SAAS,SAAS,OAAe,EAAE,YAAoB,KAAK;IACjE,MAAM,cAAc;QAAE,GAAG,OAAO;IAAC;IACjC,OAAO,AAAC,YAAoB,GAAG,EAAE,6CAA6C;IAC9E,OAAO,kJAAG,CAAC,IAAI,CAAC,aAAa,QAAQ;QAAE;IAAU;AACnD;AAKO,SAAS,WAAW,KAAa;IACtC,OAAO,kJAAG,CAAC,MAAM,CAAC,OAAO;AAC3B;AAKO,SAAS,YAAY,OAAe,EAAE,YAAoB,IAAI;IACnE,MAAM,cAAc;QAAE,GAAG,OAAO;IAAC;IACjC,OAAO,AAAC,YAAoB,GAAG;IAC/B,OAAO,kJAAG,CAAC,IAAI,CAAC,aAAa,QAAQ;QAAE;IAAU;AACnD;AAKO,SAAS,cAAc,KAAa;IACzC,OAAO,kJAAG,CAAC,MAAM,CAAC,OAAO;AAC3B","debugId":null}},
    {"offset": {"line": 112, "column": 0}, "map": {"version":3,"sources":["file:///E:/Attack%20Capital/SignalHub/frontend/src/app/api/auth/oauth/google/start/route.ts"],"sourcesContent":["// app/api/auth/oauth/google/start/route.ts\r\nimport { NextResponse } from \"next/server\";\r\nimport { signTemp } from \"@/lib/jwt\";\r\n\r\nexport async function GET(req: Request) {\r\n  const url = new URL(req.url);\r\n  const redirect = url.searchParams.get(\"redirect\") || \"/\";\r\n  const inviteId = url.searchParams.get(\"inviteId\") || null;\r\n  const flow = url.searchParams.get(\"flow\") || \"signup\";\r\n\r\n  const state = signTemp({ redirect, inviteId, flow }, \"10m\");\r\n\r\n  const params = new URLSearchParams({\r\n    client_id: process.env.GOOGLE_CLIENT_ID!,\r\n    redirect_uri: `${process.env.NEXT_PUBLIC_APP_URL}/api/auth/oauth/google/callback`,\r\n    response_type: \"code\",\r\n    scope: \"openid email profile\",\r\n    state,\r\n    access_type: \"offline\",\r\n    prompt: \"select_account\",\r\n  });\r\n\r\n  const googleUrl = `https://accounts.google.com/o/oauth2/v2/auth?${params.toString()}`;\r\n  return NextResponse.redirect(googleUrl);\r\n}\r\n"],"names":[],"mappings":"AAAA,2CAA2C;;;;;AAC3C;AACA;;;AAEO,eAAe,IAAI,GAAY;IACpC,MAAM,MAAM,IAAI,IAAI,IAAI,GAAG;IAC3B,MAAM,WAAW,IAAI,YAAY,CAAC,GAAG,CAAC,eAAe;IACrD,MAAM,WAAW,IAAI,YAAY,CAAC,GAAG,CAAC,eAAe;IACrD,MAAM,OAAO,IAAI,YAAY,CAAC,GAAG,CAAC,WAAW;IAE7C,MAAM,QAAQ,IAAA,+HAAQ,EAAC;QAAE;QAAU;QAAU;IAAK,GAAG;IAErD,MAAM,SAAS,IAAI,gBAAgB;QACjC,WAAW,QAAQ,GAAG,CAAC,gBAAgB;QACvC,cAAc,6DAAmC,+BAA+B,CAAC;QACjF,eAAe;QACf,OAAO;QACP;QACA,aAAa;QACb,QAAQ;IACV;IAEA,MAAM,YAAY,CAAC,6CAA6C,EAAE,OAAO,QAAQ,IAAI;IACrF,OAAO,gJAAY,CAAC,QAAQ,CAAC;AAC/B","debugId":null}}]
}