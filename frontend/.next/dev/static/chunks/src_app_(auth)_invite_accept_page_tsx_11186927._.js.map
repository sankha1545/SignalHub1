{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["E:/Attack Capital/SignalHub/frontend/src/app/(auth)/invite/accept/page.tsx"],"sourcesContent":["// app/(auth)/invite/accept/page.tsx\r\n\"use client\";\r\nimport React, { useEffect, useState } from \"react\";\r\nimport { useSearchParams, useRouter } from \"next/navigation\";\r\n\r\ntype InvitePayload = {\r\n  ok: boolean;\r\n  email?: string;\r\n  preverifiedEmail?: boolean;\r\n  role?: string | null;\r\n  organizationId?: string | null;\r\n  organizationName?: string | null;\r\n  teamId?: string | null;\r\n  expiresAt?: string | null;\r\n  createdAt?: string | null;\r\n  message?: string;\r\n};\r\n\r\nexport default function InviteAcceptPage() {\r\n  const searchParams = useSearchParams();\r\n  const router = useRouter();\r\n  const token = searchParams.get(\"token\") ?? \"\";\r\n\r\n  const [loading, setLoading] = useState<boolean>(true);\r\n  const [invite, setInvite] = useState<InvitePayload | null>(null);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  // form state\r\n  const [name, setName] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [phone, setPhone] = useState(\"\");\r\n\r\n  // phone verification state\r\n  const [smsSending, setSmsSending] = useState(false);\r\n  const [smsSent, setSmsSent] = useState(false);\r\n  const [smsCode, setSmsCode] = useState(\"\");\r\n  const [smsVerifying, setSmsVerifying] = useState(false);\r\n  const [phoneVerified, setPhoneVerified] = useState(false);\r\n\r\n  // submission\r\n  const [submitting, setSubmitting] = useState(false);\r\n\r\n  // auth check (to warn if a logged-in user opens an invite)\r\n  const [currentUserEmail, setCurrentUserEmail] = useState<string | null>(null);\r\n  const [checkingAuth, setCheckingAuth] = useState(true);\r\n\r\n  useEffect(() => {\r\n    // If token missing, short-circuit\r\n    if (!token) {\r\n      setError(\"Missing invite token\");\r\n      setLoading(false);\r\n      setCheckingAuth(false);\r\n      return;\r\n    }\r\n\r\n    // fetch invite metadata\r\n    setLoading(true);\r\n    fetch(\"/api/invites/accept\", {\r\n      method: \"POST\",\r\n      headers: { \"Content-Type\": \"application/json\" },\r\n      body: JSON.stringify({ token }),\r\n    })\r\n      .then((r) => r.json())\r\n      .then((json: InvitePayload) => {\r\n        if (!json || !json.ok) {\r\n          throw new Error(json?.message || \"Invalid invite\");\r\n        }\r\n        setInvite(json);\r\n      })\r\n      .catch((err: any) => {\r\n        console.error(\"Invite accept error:\", err);\r\n        setError(err?.message || \"Could not load invite\");\r\n      })\r\n      .finally(() => setLoading(false));\r\n\r\n    // check /api/me to detect if visitor is already signed in (so we can warn)\r\n    setCheckingAuth(true);\r\n    fetch(\"/api/me\")\r\n      .then((r) => {\r\n        if (!r.ok) return null;\r\n        return r.json();\r\n      })\r\n      .then((json: any) => {\r\n        if (json && json?.email) setCurrentUserEmail(String(json.email));\r\n      })\r\n      .catch(() => {\r\n        /* ignore */\r\n      })\r\n      .finally(() => setCheckingAuth(false));\r\n  }, [token]);\r\n\r\n  // send SMS code\r\n  async function handleSendSms() {\r\n    if (!phone) {\r\n      setError(\"Please enter phone number to receive SMS\");\r\n      return;\r\n    }\r\n    setError(null);\r\n    setSmsSending(true);\r\n    try {\r\n      const res = await fetch(\"/api/auth/phone/send\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ phone }),\r\n      });\r\n      const json = await res.json();\r\n      if (!json?.ok) {\r\n        throw new Error(json?.message || \"Failed to send SMS\");\r\n      }\r\n      setSmsSent(true);\r\n    } catch (err: any) {\r\n      console.error(\"SMS send error:\", err);\r\n      setError(err?.message || \"Failed to send SMS\");\r\n    } finally {\r\n      setSmsSending(false);\r\n    }\r\n  }\r\n\r\n  // verify SMS code\r\n  async function handleVerifySms() {\r\n    if (!smsCode) {\r\n      setError(\"Enter the code you received by SMS\");\r\n      return;\r\n    }\r\n    setError(null);\r\n    setSmsVerifying(true);\r\n    try {\r\n      const res = await fetch(\"/api/auth/phone/verify\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ phone, code: smsCode }),\r\n      });\r\n      const json = await res.json();\r\n      if (!json?.ok) throw new Error(json?.message || \"Verification failed\");\r\n      setPhoneVerified(true);\r\n      setError(null);\r\n    } catch (err: any) {\r\n      console.error(\"SMS verify error:\", err);\r\n      setError(err?.message || \"Failed to verify code\");\r\n    } finally {\r\n      setSmsVerifying(false);\r\n    }\r\n  }\r\n\r\n  // finalize invite -> create account\r\n  async function handleSubmit(e: React.FormEvent) {\r\n    e.preventDefault();\r\n    setError(null);\r\n\r\n    if (!invite?.email) {\r\n      setError(\"Invite data missing\");\r\n      return;\r\n    }\r\n    if (!password || password.length < 8) {\r\n      setError(\"Password must be at least 8 characters\");\r\n      return;\r\n    }\r\n\r\n    // basic name validation (optional)\r\n    if (name && name.length > 100) {\r\n      setError(\"Name is too long\");\r\n      return;\r\n    }\r\n\r\n    setSubmitting(true);\r\n    try {\r\n      const payload: any = {\r\n        token,\r\n        name: name || undefined,\r\n        password,\r\n      };\r\n      if (phone) {\r\n        payload.phone = phone;\r\n        // only tell server that phone was verified if we actually verified it via endpoint\r\n        if (phoneVerified) payload.phoneVerified = true;\r\n      }\r\n\r\n      const res = await fetch(\"/api/invites/finalize\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify(payload),\r\n      });\r\n      const json = await res.json();\r\n      if (!json?.ok) {\r\n        throw new Error(json?.message || \"Failed to create account\");\r\n      }\r\n\r\n      // Success: redirect to login or welcome screen\r\n      // We intentionally don't auto-show token. We can show a friendly page instead.\r\n      router.push(\"/auth/login?created=1\");\r\n    } catch (err: any) {\r\n      console.error(\"Finalize error:\", err);\r\n      setError(err?.message || \"Failed to create account\");\r\n    } finally {\r\n      setSubmitting(false);\r\n    }\r\n  }\r\n\r\n  if (loading || checkingAuth) {\r\n    return <div style={{ padding: 24 }}>Loading…</div>;\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div style={{ padding: 24 }}>\r\n        <h1>Invite</h1>\r\n        <p style={{ color: \"red\" }}>{error}</p>\r\n        <p>\r\n          If you think this is a mistake, contact the organization that invited you or try requesting a\r\n          new invite.\r\n        </p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!invite) {\r\n    return (\r\n      <div style={{ padding: 24 }}>\r\n        <h1>Invite</h1>\r\n        <p>Invite not found or invalid.</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // If a user is already signed in, show a warning and suggest using a private window to accept\r\n  const showSignedInWarning = !!currentUserEmail;\r\n\r\n  return (\r\n    <div style={{ maxWidth: 720, margin: \"24px auto\", padding: 16 }}>\r\n      <h1 style={{ marginBottom: 8 }}>You're invited to join</h1>\r\n\r\n      <div style={{ padding: 12, borderRadius: 8, background: \"#f8fafc\", marginBottom: 18 }}>\r\n        <div style={{ fontSize: 18, fontWeight: 600 }}>\r\n          {invite.organizationName ?? \"the organization\"}\r\n        </div>\r\n        <div style={{ marginTop: 6 }}>\r\n          Invite for: <strong>{invite.email}</strong>{\" \"}\r\n          {invite.preverifiedEmail ? (\r\n            <span style={{ color: \"green\", marginLeft: 8 }}>✔ email verified by invite</span>\r\n          ) : null}\r\n        </div>\r\n        {invite.role ? <div style={{ marginTop: 6 }}>Role: <strong>{invite.role}</strong></div> : null}\r\n        {invite.expiresAt ? <div style={{ marginTop: 6, fontSize: 12 }}>Expires: {new Date(invite.expiresAt).toLocaleString()}</div> : null}\r\n      </div>\r\n\r\n      {showSignedInWarning ? (\r\n        <div style={{ padding: 12, border: \"1px solid #f1c40f\", background: \"#fff7e6\", borderRadius: 8, marginBottom: 16 }}>\r\n          <strong>Warning:</strong> You're currently signed in as <strong>{currentUserEmail}</strong>. To accept this invite\r\n          as a different account, sign out first or open the invite link in a private/incognito window.\r\n        </div>\r\n      ) : null}\r\n\r\n      <form onSubmit={handleSubmit} style={{ display: \"grid\", gap: 12 }}>\r\n        {/* Email (locked) */}\r\n        <label style={{ display: \"block\" }}>\r\n          Email (locked)\r\n          <input value={invite.email} readOnly style={{ width: \"100%\", padding: 10, marginTop: 6 }} />\r\n        </label>\r\n\r\n        {/* Name */}\r\n        <label style={{ display: \"block\" }}>\r\n          Full name\r\n          <input\r\n            value={name}\r\n            onChange={(e) => setName(e.target.value)}\r\n            placeholder=\"Your full name\"\r\n            style={{ width: \"100%\", padding: 10, marginTop: 6 }}\r\n          />\r\n        </label>\r\n\r\n        {/* Phone + SMS verify */}\r\n        <div style={{ display: \"grid\", gap: 8 }}>\r\n          <label>\r\n            Phone (optional)\r\n            <input\r\n              value={phone}\r\n              onChange={(e) => {\r\n                setPhone(e.target.value);\r\n                setSmsSent(false);\r\n                setPhoneVerified(false);\r\n              }}\r\n              placeholder=\"+91xxxxxxxxxx\"\r\n              style={{ width: \"100%\", padding: 10, marginTop: 6 }}\r\n            />\r\n          </label>\r\n\r\n          <div style={{ display: \"flex\", gap: 8, alignItems: \"center\" }}>\r\n            <button\r\n              type=\"button\"\r\n              onClick={handleSendSms}\r\n              disabled={!phone || smsSending}\r\n              style={{ padding: \"8px 12px\" }}\r\n            >\r\n              {smsSending ? \"Sending…\" : smsSent ? \"Resend code\" : \"Send verification code\"}\r\n            </button>\r\n\r\n            {smsSent && !phoneVerified ? (\r\n              <>\r\n                <input\r\n                  value={smsCode}\r\n                  onChange={(e) => setSmsCode(e.target.value)}\r\n                  placeholder=\"Enter code\"\r\n                  style={{ padding: 8 }}\r\n                />\r\n                <button type=\"button\" onClick={handleVerifySms} disabled={smsVerifying} style={{ padding: \"8px 12px\" }}>\r\n                  {smsVerifying ? \"Verifying…\" : \"Verify\"}\r\n                </button>\r\n              </>\r\n            ) : null}\r\n\r\n            {phoneVerified ? <span style={{ color: \"green\" }}>✔ Phone verified</span> : null}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Password */}\r\n        <label style={{ display: \"block\" }}>\r\n          Password\r\n          <input\r\n            type=\"password\"\r\n            value={password}\r\n            onChange={(e) => setPassword(e.target.value)}\r\n            placeholder=\"Choose a secure password (8+ characters)\"\r\n            style={{ width: \"100%\", padding: 10, marginTop: 6 }}\r\n          />\r\n        </label>\r\n\r\n        {error ? <div style={{ color: \"red\" }}>{error}</div> : null}\r\n\r\n        <div style={{ display: \"flex\", gap: 8, alignItems: \"center\" }}>\r\n          <button type=\"submit\" disabled={submitting} style={{ padding: \"10px 14px\" }}>\r\n            {submitting ? \"Creating account…\" : `Create account and join ${invite.organizationName ?? \"team\"}`}\r\n          </button>\r\n\r\n          <button\r\n            type=\"button\"\r\n            onClick={() => router.push(\"/auth/login\")}\r\n            style={{ padding: \"10px 14px\", background: \"transparent\", border: \"1px solid #ddd\" }}\r\n          >\r\n            Already have an account? Log in\r\n          </button>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  );\r\n}\r\n"],"names":["React","useEffect","useState","useSearchParams","useRouter","InvitePayload","ok","email","preverifiedEmail","role","organizationId","organizationName","teamId","expiresAt","createdAt","message","InviteAcceptPage","searchParams","router","token","get","loading","setLoading","invite","setInvite","error","setError","name","setName","password","setPassword","phone","setPhone","smsSending","setSmsSending","smsSent","setSmsSent","smsCode","setSmsCode","smsVerifying","setSmsVerifying","phoneVerified","setPhoneVerified","submitting","setSubmitting","currentUserEmail","setCurrentUserEmail","checkingAuth","setCheckingAuth","fetch","method","headers","body","JSON","stringify","then","r","json","Error","catch","err","console","finally","String","handleSendSms","res","handleVerifySms","code","handleSubmit","e","FormEvent","preventDefault","length","payload","undefined","push","padding","color","showSignedInWarning","maxWidth","margin","marginBottom","borderRadius","background","fontSize","fontWeight","marginTop","marginLeft","Date","toLocaleString","border","display","gap","width","target","value","alignItems"],"mappings":"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","ignoreList":[],"debugId":null}}]
}