{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["E:/Attack Capital/SignalHub/frontend/src/components/chat/MessageBubble.tsx"],"sourcesContent":["\"use client\";\r\n\r\n\r\nimport React from \"react\";\r\n\r\n\r\nexport default function MessageBubble({ message, currentUserId }: any) {\r\nconst mine = message.senderId === currentUserId;\r\nconst role = message.meta?.role || \"employee\";\r\nreturn (\r\n<div className={`flex ${mine ? \"justify-end\" : \"justify-start\"}`}>\r\n<div className={`max-w-[70%] p-2 rounded-lg ${mine ? \"bg-blue-600 text-white\" : \"bg-gray-100 text-black\"}`}>\r\n<div className=\"text-xs opacity-70\">{message.senderName || message.senderId} • {role}</div>\r\n<div className=\"mt-1 whitespace-pre-wrap\">{message.content}</div>\r\n<div className=\"text-[10px] opacity-60 text-right mt-1\">{new Date(message.createdAt).toLocaleTimeString()}</div>\r\n</div>\r\n</div>\r\n);\r\n}"],"names":["c","_c","React","MessageBubble","t0","$","$i","Symbol","for","message","currentUserId","mine","senderId","role","meta","t1","t2","t3","senderName","t4","t5","content","t6","createdAt","Date","toLocaleTimeString","t7","t8","t9"],"mappings":"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","ignoreList":[],"debugId":null}},
    {"offset": {"line": 135, "column": 0}, "map": {"version":3,"sources":["E:/Attack Capital/SignalHub/frontend/src/components/chat/TeamChat.tsx"],"sourcesContent":["// src/components/chat/TeamChat.tsx\r\n\"use client\";\r\n\r\nimport React, { useEffect, useRef, useState } from \"react\";\r\nimport socketClient from \"@/lib/socketClient\";\r\nimport MessageBubble from \"@/components/chat/MessageBubble\";\r\n\r\ntype MinimalUser = { id: string; role?: string; name?: string; email?: string };\r\n\r\nexport type ChatMessage = {\r\n  id: string;\r\n  chatId: string;\r\n  content: string;\r\n  metadata?: any;\r\n  externalId?: string | null;\r\n  createdAt?: string | null;\r\n  sender?: { id: string; name?: string | null; email?: string | null } | null;\r\n};\r\n\r\nexport default function TeamChat({\r\n  chatId,\r\n  currentUser,\r\n}: {\r\n  chatId: string;\r\n  currentUser: MinimalUser;\r\n}) {\r\n  const [messages, setMessages] = useState<ChatMessage[]>([]);\r\n  const [text, setText] = useState(\"\");\r\n  const [sending, setSending] = useState(false);\r\n  const listRef = useRef<HTMLDivElement | null>(null);\r\n\r\n  // track IDs we've seen to prevent duplicates (optimistic + server)\r\n  const seenIdsRef = useRef<Set<string>>(new Set());\r\n\r\n  // fetch history and join room\r\n  useEffect(() => {\r\n    let mounted = true;\r\n    const fetchHistory = async () => {\r\n      try {\r\n        const res = await fetch(`/api/chats/${encodeURIComponent(chatId)}`, { credentials: \"same-origin\" });\r\n        if (!mounted) return;\r\n        const j = await res.json().catch(() => ({}));\r\n        const msgs: ChatMessage[] = j?.messages ?? [];\r\n        // dedupe and set\r\n        seenIdsRef.current = new Set(msgs.map((m) => m.id));\r\n        if (mounted) setMessages(msgs);\r\n      } catch (err) {\r\n        console.warn(\"Failed to load chat history\", err);\r\n      }\r\n    };\r\n\r\n    fetchHistory();\r\n\r\n    // join room on socket\r\n    try {\r\n      // some socket servers expect: \"join-room\", payload chatId\r\n      socketClient.emit(\"join-room\", chatId);\r\n    } catch (err) {\r\n      console.warn(\"Socket join-room failed\", err);\r\n    }\r\n\r\n    return () => {\r\n      mounted = false;\r\n      try {\r\n        socketClient.emit(\"leave-room\", chatId);\r\n      } catch (err) {\r\n        // ignore\r\n      }\r\n    };\r\n  }, [chatId]);\r\n\r\n  // message handler from socket (server broadcasts \"chat:message\")\r\n  useEffect(() => {\r\n    const handler = (payload: any) => {\r\n      try {\r\n        // Expect server to send: { chatId, message: { ... } } or message directly\r\n        const incomingChatId = payload?.chatId ?? payload?.message?.chatId ?? payload?.message?.chat_id;\r\n        const msg = payload?.message ?? (payload?.id ? payload : null);\r\n        if (!msg || incomingChatId !== chatId) return;\r\n\r\n        // dedupe by id\r\n        if (msg.id && seenIdsRef.current.has(msg.id)) return;\r\n        if (msg.id) seenIdsRef.current.add(msg.id);\r\n\r\n        setMessages((prev) => {\r\n          // avoid double optimistic message (match by temporary id -> replace)\r\n          if (msg.id && String(msg.id).startsWith(\"local-\")) {\r\n            // shouldn't happen from server, but handle defensively\r\n            return prev.map((p) => (p.id === msg.id ? msg : p));\r\n          }\r\n\r\n          // if we have a local optimistic message with same content and sender/time close, try to replace it\r\n          const optimisticIndex = prev.findIndex((p) => p.id?.startsWith(\"local-\") && p.content === msg.content && p.sender?.id === msg.sender?.id);\r\n          if (optimisticIndex >= 0) {\r\n            const copy = [...prev];\r\n            copy[optimisticIndex] = msg;\r\n            return copy;\r\n          }\r\n\r\n          return [...prev, msg];\r\n        });\r\n      } catch (err) {\r\n        console.warn(\"Error handling incoming socket message\", err);\r\n      }\r\n    };\r\n\r\n    // listen for server event name — your server emits 'chat:message'\r\n    socketClient.on(\"chat:message\", handler);\r\n\r\n    // also listen for older 'message' or generic events if any\r\n    socketClient.on(\"message\", handler);\r\n\r\n    return () => {\r\n      socketClient.off(\"chat:message\", handler);\r\n      socketClient.off(\"message\", handler);\r\n    };\r\n  }, [chatId]);\r\n\r\n  // scroll to bottom when messages change\r\n  useEffect(() => {\r\n    if (!listRef.current) return;\r\n    // use requestAnimationFrame to wait for DOM update\r\n    requestAnimationFrame(() => {\r\n      try {\r\n        listRef.current!.scrollTop = listRef.current!.scrollHeight;\r\n      } catch (e) {\r\n        // ignore\r\n      }\r\n    });\r\n  }, [messages.length]);\r\n\r\n  const send = async () => {\r\n    const trimmed = text.trim();\r\n    if (!trimmed || sending) return;\r\n    setSending(true);\r\n\r\n    // build payload expected by your server\r\n    const payload = {\r\n      content: trimmed,\r\n      metadata: { role: currentUser?.role ?? null },\r\n      // don't need chatId here for POST as it's in URL, but keep for optimistic\r\n      chatId,\r\n    };\r\n\r\n    // optimistic UI - add local temporary message id\r\n    const localMsg: ChatMessage = {\r\n      id: `local-${Date.now()}-${Math.random().toString(36).slice(2, 7)}`,\r\n      chatId,\r\n      content: trimmed,\r\n      metadata: payload.metadata,\r\n      createdAt: new Date().toISOString(),\r\n      sender: { id: currentUser.id, name: (currentUser as any).name ?? null, email: (currentUser as any).email ?? null },\r\n    };\r\n    seenIdsRef.current.add(localMsg.id);\r\n    setMessages((m) => [...m, localMsg]);\r\n    setText(\"\");\r\n\r\n    // emit via socket (best-effort) — servers may handle incoming events differently\r\n    try {\r\n      // emit to server so others get it instantly (server should create/persist and broadcast)\r\n      // Emit both common event names so integration is robust\r\n      socketClient.emit(\"message\", { chatId, message: payload });\r\n      socketClient.emit(\"chat:message\", { chatId, message: payload });\r\n      // some servers expect a dedicated event name like \"chat:post\" — adjust if needed\r\n      socketClient.emit(\"chat:post\", { chatId, message: payload });\r\n    } catch (err) {\r\n      console.warn(\"Socket emit failed (non-fatal)\", err);\r\n    }\r\n\r\n    // persist via API (server will broadcast to others on create)\r\n    try {\r\n      const res = await fetch(`/api/chats/${encodeURIComponent(chatId)}`, {\r\n        method: \"POST\",\r\n        credentials: \"same-origin\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify(payload),\r\n      });\r\n\r\n      if (res.ok) {\r\n        const j = await res.json().catch(() => ({}));\r\n        // server returns created message as j.message — replace local optimistic with server result (by content/sender/closest time)\r\n        const created: ChatMessage | undefined = j?.message ?? undefined;\r\n        if (created && created.id) {\r\n          // if server returns an id that's not our local id, replace the optimistic local message\r\n          setMessages((prev) => {\r\n            // find local optimistic message by matching content + sender + a recent createdAt\r\n            const idx = prev.findIndex((p) => p.id?.startsWith(\"local-\") && p.content === created.content && p.sender?.id === created.sender?.id);\r\n            if (idx >= 0) {\r\n              const copy = [...prev];\r\n              copy[idx] = created;\r\n              seenIdsRef.current.add(created.id);\r\n              // remove old local id from seen set\r\n              prev[idx].id && seenIdsRef.current.delete(prev[idx].id);\r\n              return copy;\r\n            }\r\n            // otherwise append if not already present\r\n            if (!created.id || !seenIdsRef.current.has(created.id)) {\r\n              seenIdsRef.current.add(created.id);\r\n              return [...prev, created];\r\n            }\r\n            return prev;\r\n          });\r\n        } else {\r\n          // if server didn't return message object, optionally refetch or ignore (we rely on socket broadcast)\r\n        }\r\n      } else {\r\n        console.warn(\"Message persist returned non-OK\", res.status);\r\n      }\r\n    } catch (err) {\r\n      console.warn(\"Failed to persist message\", err);\r\n    } finally {\r\n      setSending(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"flex flex-col h-full min-h-[200px]\">\r\n      <div ref={listRef} className=\"flex-1 overflow-auto p-4 space-y-3\">\r\n        {messages.map((m) => (\r\n          <MessageBubble key={m.id} message={m as any} currentUserId={currentUser.id} />\r\n        ))}\r\n        {messages.length === 0 && <div className=\"text-sm text-slate-500\">No messages yet.</div>}\r\n      </div>\r\n\r\n      <div className=\"p-3 border-t flex items-center gap-2\">\r\n        <input\r\n          value={text}\r\n          onChange={(e) => setText(e.target.value)}\r\n          onKeyDown={(e) => {\r\n            if (e.key === \"Enter\" && !e.shiftKey) {\r\n              e.preventDefault();\r\n              send();\r\n            }\r\n          }}\r\n          placeholder=\"Write a message...\"\r\n          className=\"flex-1 rounded-md border px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500/30\"\r\n          aria-label=\"Type a message\"\r\n          disabled={sending}\r\n        />\r\n        <button\r\n          onClick={send}\r\n          disabled={sending || text.trim().length === 0}\r\n          className={`px-4 py-2 rounded-md text-sm font-medium ${sending ? \"opacity-60 cursor-wait bg-slate-200\" : \"bg-blue-600 text-white hover:bg-blue-700\"}`}\r\n        >\r\n          {sending ? \"Sending…\" : \"Send\"}\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":["React","useEffect","useRef","useState","socketClient","MessageBubble","MinimalUser","id","role","name","email","ChatMessage","chatId","content","metadata","externalId","createdAt","sender","TeamChat","currentUser","messages","setMessages","text","setText","sending","setSending","listRef","HTMLDivElement","seenIdsRef","Set","mounted","fetchHistory","res","fetch","encodeURIComponent","credentials","j","json","catch","msgs","current","map","m","err","console","warn","emit","handler","payload","incomingChatId","message","chat_id","msg","has","add","prev","String","startsWith","p","optimisticIndex","findIndex","copy","on","off","requestAnimationFrame","scrollTop","scrollHeight","e","length","send","trimmed","trim","localMsg","Date","now","Math","random","toString","slice","toISOString","method","headers","body","JSON","stringify","ok","created","undefined","idx","delete","status","target","value","key","shiftKey","preventDefault"],"mappings":"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","ignoreList":[],"debugId":null}}]
}