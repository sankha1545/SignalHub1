{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["E:/Attack Capital/SignalHub/frontend/src/components/forms/ProfileMenu.tsx"],"sourcesContent":["// src/components/ProfileMenu.tsx\r\n\"use client\";\r\n\r\nimport React, { useEffect, useRef, useState } from \"react\";\r\nimport { motion, AnimatePresence } from \"framer-motion\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport {\r\n  User as UserIcon,\r\n  Settings,\r\n  LogOut,\r\n  HelpCircle,\r\n  Moon,\r\n  Sun,\r\n  ChevronDown,\r\n  Crown,\r\n  Bell,\r\n  Zap\r\n} from \"lucide-react\";\r\n\r\ntype Profile = {\r\n  avatarUrl?: string | null;\r\n  displayName?: string | null;\r\n};\r\n\r\ntype MeUser = {\r\n  id: string;\r\n  name?: string | null;\r\n  email?: string | null;\r\n  role?: string | null;\r\n  profile?: Profile | null;\r\n};\r\n\r\nexport default function ProfileMenu() {\r\n  const router = useRouter();\r\n  const ref = useRef<HTMLDivElement | null>(null);\r\n\r\n  const [user, setUser] = useState<MeUser | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const [isDarkMode, setIsDarkMode] = useState(false);\r\n\r\n  // load current user on mount\r\n  useEffect(() => {\r\n    let mounted = true;\r\n    async function load() {\r\n      try {\r\n        const res = await fetch(\"/api/me\");\r\n        if (!res.ok) {\r\n          if (mounted) setUser(null);\r\n          return;\r\n        }\r\n        const json = await res.json().catch(() => null);\r\n        if (mounted && json?.ok && json.user) setUser(json.user as MeUser);\r\n      } catch (err) {\r\n        // ignore errors\r\n      } finally {\r\n        if (mounted) setLoading(false);\r\n      }\r\n    }\r\n    load();\r\n    return () => {\r\n      mounted = false;\r\n    };\r\n  }, []);\r\n\r\n  // click outside to close menu\r\n  useEffect(() => {\r\n    function onDoc(e: MouseEvent) {\r\n      if (!ref.current) return;\r\n      if (!ref.current.contains(e.target as Node)) setIsOpen(false);\r\n    }\r\n    document.addEventListener(\"mousedown\", onDoc);\r\n    return () => document.removeEventListener(\"mousedown\", onDoc);\r\n  }, []);\r\n\r\n  function initials(name?: string | null, email?: string | null) {\r\n    const source = name || email || \"U\";\r\n    return (source.trim().charAt(0) || \"U\").toUpperCase();\r\n  }\r\n\r\n  async function handleLogout() {\r\n    try {\r\n      await fetch(\"/api/auth/logout\", { method: \"POST\" }).catch(() => {});\r\n    } finally {\r\n      setUser(null);\r\n      router.push(\"/login\");\r\n    }\r\n  }\r\n\r\n  const menuItems = [\r\n    {\r\n      icon: UserIcon,\r\n      label: \"Profile\",\r\n      action: () => router.push(\"/account\"),\r\n      gradient: \"from-blue-500 to-cyan-500\"\r\n    },\r\n    {\r\n      icon: Settings,\r\n      label: \"Settings\",\r\n      action: () => router.push(\"/dashboard\"),\r\n      gradient: \"from-slate-500 to-slate-700\"\r\n    },\r\n    {\r\n      icon: Bell,\r\n      label: \"Notifications\",\r\n      action: () => console.log(\"Notifications clicked\"),\r\n      gradient: \"from-violet-500 to-purple-500\",\r\n      badge: 3\r\n    },\r\n    {\r\n      icon: HelpCircle,\r\n      label: \"Help & Support\",\r\n      action: () => console.log(\"Help clicked\"),\r\n      gradient: \"from-emerald-500 to-teal-500\"\r\n    },\r\n    {\r\n      icon: LogOut,\r\n      label: \"Sign Out\",\r\n      action: handleLogout,\r\n      gradient: \"from-rose-500 to-pink-500\",\r\n      danger: true\r\n    }\r\n  ];\r\n\r\n  const displayName = user?.profile?.displayName || user?.name || user?.email || (loading ? \"Loading...\" : \"Account\");\r\n\r\n  return (\r\n    <div ref={ref} className=\"relative\">\r\n      {/* Profile trigger button */}\r\n      <motion.button\r\n        onClick={() => setIsOpen((v) => !v)}\r\n        className=\"w-full flex items-center gap-3 p-3 rounded-xl hover:bg-slate-100 transition-all duration-200 group\"\r\n        whileHover={{ scale: 1.02 }}\r\n        whileTap={{ scale: 0.98 }}\r\n        aria-haspopup=\"true\"\r\n        aria-expanded={isOpen}\r\n      >\r\n        {/* Avatar with status indicator */}\r\n        <div className=\"relative flex-shrink-0\">\r\n          <div className=\"w-10 h-10 rounded-xl bg-gradient-to-br from-blue-600 via-cyan-500 to-emerald-500 flex items-center justify-center shadow-lg shadow-blue-500/30 overflow-hidden\">\r\n            {user?.profile?.avatarUrl ? (\r\n              // eslint-disable-next-line @next/next/no-img-element\r\n              <img src={user.profile.avatarUrl} alt=\"avatar\" className=\"w-full h-full object-cover\" />\r\n            ) : (\r\n              <div className=\"text-white font-semibold\">{initials(user?.name, user?.email)}</div>\r\n            )}\r\n          </div>\r\n          <motion.div\r\n            className=\"absolute -bottom-0.5 -right-0.5 w-3.5 h-3.5 bg-emerald-400 rounded-full border-2 border-white\"\r\n            animate={{ scale: [1, 1.2, 1] }}\r\n            transition={{ duration: 2, repeat: Infinity }}\r\n          />\r\n        </div>\r\n\r\n        {/* User info */}\r\n        <div className=\"flex-1 text-left min-w-0\">\r\n          <div className=\"text-sm font-semibold text-slate-800 truncate flex items-center gap-1.5\">\r\n            {displayName}\r\n            <Crown className=\"w-3.5 h-3.5 text-amber-500\" />\r\n          </div>\r\n          <div className=\"text-xs text-slate-500 truncate\">{user?.email || \"\"}</div>\r\n        </div>\r\n\r\n        {/* Dropdown indicator */}\r\n        <motion.div animate={{ rotate: isOpen ? 180 : 0 }} transition={{ duration: 0.3 }}>\r\n          <ChevronDown className=\"w-4 h-4 text-slate-400 group-hover:text-slate-600 transition-colors\" />\r\n        </motion.div>\r\n      </motion.button>\r\n\r\n      {/* Dropdown menu */}\r\n      <AnimatePresence>\r\n        {isOpen && (\r\n          <>\r\n            {/* Backdrop for mobile */}\r\n            <motion.div\r\n              className=\"fixed inset-0 z-40 lg:hidden\"\r\n              initial={{ opacity: 0 }}\r\n              animate={{ opacity: 1 }}\r\n              exit={{ opacity: 0 }}\r\n              onClick={() => setIsOpen(false)}\r\n            />\r\n\r\n            {/* Menu */}\r\n            <motion.div\r\n              initial={{ opacity: 0, y: 10, scale: 0.95 }}\r\n              animate={{ opacity: 1, y: 0, scale: 1 }}\r\n              exit={{ opacity: 0, y: 10, scale: 0.95 }}\r\n              transition={{ duration: 0.2 }}\r\n              className=\"absolute bottom-full left-0 right-0 mb-2 z-50 bg-white rounded-xl shadow-2xl border border-slate-200 overflow-hidden\"\r\n            >\r\n              {/* Pro badge */}\r\n              <div className=\"p-3 bg-gradient-to-r from-amber-50 to-orange-50 border-b border-amber-100\">\r\n                <div className=\"flex items-center gap-2\">\r\n                  <div className=\"w-8 h-8 rounded-lg bg-gradient-to-br from-amber-400 to-orange-500 flex items-center justify-center shadow-lg\">\r\n                    <Crown className=\"w-4 h-4 text-white\" />\r\n                  </div>\r\n                  <div className=\"flex-1 min-w-0\">\r\n                    <div className=\"text-xs font-bold text-amber-900\">Pro Member</div>\r\n                    <div className=\"text-[10px] text-amber-700\">Premium features unlocked</div>\r\n                  </div>\r\n                  <Zap className=\"w-4 h-4 text-amber-500\" />\r\n                </div>\r\n              </div>\r\n\r\n              {/* Menu items */}\r\n              <div className=\"p-2\">\r\n                {menuItems.map((item, index) => {\r\n                  const Icon = item.icon as any;\r\n                  return (\r\n                    <motion.button\r\n                      key={item.label}\r\n                      initial={{ opacity: 0, x: -10 }}\r\n                      animate={{ opacity: 1, x: 0 }}\r\n                      transition={{ delay: index * 0.05 }}\r\n                      onClick={() => {\r\n                        item.action();\r\n                        setIsOpen(false);\r\n                      }}\r\n                      className={`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium transition-all duration-200 group ${\r\n                        item.danger\r\n                          ? \"hover:bg-rose-50 text-rose-600\"\r\n                          : \"hover:bg-slate-50 text-slate-700\"\r\n                      }`}\r\n                      whileHover={{ x: 4 }}\r\n                    >\r\n                      <div className={`w-8 h-8 rounded-lg bg-gradient-to-br ${item.gradient} flex items-center justify-center shadow-sm`}>\r\n                        <Icon className=\"w-4 h-4 text-white\" />\r\n                      </div>\r\n                      <span className=\"flex-1 text-left\">{item.label}</span>\r\n                      {item.badge && (\r\n                        <span className=\"px-2 py-0.5 text-[10px] font-bold bg-rose-500 text-white rounded-full\">{item.badge}</span>\r\n                      )}\r\n                    </motion.button>\r\n                  );\r\n                })}\r\n              </div>\r\n\r\n              {/* Dark mode toggle */}\r\n              <div className=\"p-3 border-t border-slate-200 bg-slate-50\">\r\n                <div className=\"flex items-center justify-between\">\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <div className=\"w-8 h-8 rounded-lg bg-gradient-to-br from-slate-600 to-slate-800 flex items-center justify-center shadow-sm\">\r\n                      {isDarkMode ? <Moon className=\"w-4 h-4 text-white\" /> : <Sun className=\"w-4 h-4 text-white\" />}\r\n                    </div>\r\n                    <span className=\"text-sm font-medium text-slate-700\">Dark Mode</span>\r\n                  </div>\r\n                  <motion.button\r\n                    onClick={() => setIsDarkMode(!isDarkMode)}\r\n                    className={`relative w-11 h-6 rounded-full transition-colors duration-300 ${\r\n                      isDarkMode ? \"bg-gradient-to-r from-blue-500 to-cyan-500\" : \"bg-slate-300\"\r\n                    }`}\r\n                    whileTap={{ scale: 0.95 }}\r\n                  >\r\n                    <motion.div\r\n                      className=\"absolute top-0.5 left-0.5 w-5 h-5 bg-white rounded-full shadow-md\"\r\n                      animate={{ x: isDarkMode ? 20 : 0 }}\r\n                      transition={{ type: \"spring\", stiffness: 500, damping: 30 }}\r\n                    />\r\n                  </motion.button>\r\n                </div>\r\n              </div>\r\n            </motion.div>\r\n          </>\r\n        )}\r\n      </AnimatePresence>\r\n    </div>\r\n  );\r\n}\r\n"],"names":["React","useEffect","useRef","useState","motion","AnimatePresence","useRouter","User","UserIcon","Settings","LogOut","HelpCircle","Moon","Sun","ChevronDown","Crown","Bell","Zap","Profile","avatarUrl","displayName","MeUser","id","name","email","role","profile","ProfileMenu","router","ref","HTMLDivElement","user","setUser","loading","setLoading","isOpen","setIsOpen","isDarkMode","setIsDarkMode","mounted","load","res","fetch","ok","json","catch","err","onDoc","e","MouseEvent","current","contains","target","Node","document","addEventListener","removeEventListener","initials","source","trim","charAt","toUpperCase","handleLogout","method","push","menuItems","icon","label","action","gradient","console","log","badge","danger","v","scale","duration","repeat","Infinity","rotate","opacity","y","map","item","index","Icon","x","delay","type","stiffness","damping"],"mappings":"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","ignoreList":[],"debugId":null}},
    {"offset": {"line": 540, "column": 0}, "map": {"version":3,"sources":["E:/Attack Capital/SignalHub/frontend/src/components/ui/sidebar/Sidebar.tsx"],"sourcesContent":["// components/ui/sidebar/Sidebar.tsx\r\n\"use client\";\r\n\r\nimport React, { useEffect, useRef, useState } from \"react\";\r\nimport Link from \"next/link\";\r\nimport { usePathname } from \"next/navigation\";\r\nimport clsx from \"clsx\";\r\nimport { motion, AnimatePresence } from \"framer-motion\";\r\nimport {\r\n  LayoutDashboard,\r\n  Inbox,\r\n  Send,\r\n  Users,\r\n  BarChart3,\r\n  Settings,\r\n  Search,\r\n  Menu,\r\n  X,\r\n  ChevronRight,\r\n  Sparkles,\r\n  ArrowRight,\r\n  Calendar,\r\n  Clock,\r\n  Plus,\r\n  Clipboard,\r\n  Slack,\r\n  User,\r\n  CheckCircle,\r\n  Bell,\r\n  CalendarClock,\r\n} from \"lucide-react\";\r\nimport ProfileMenu from \"@/components/forms/ProfileMenu\";\r\n\r\n/**\r\n * Sidebar component that renders portal-specific navigation.\r\n *\r\n * Props:\r\n * - portal?: \"admin\" | \"manager\" | \"employee\" (default \"admin\")\r\n * - isOpen?: boolean (controlled mobile drawer)\r\n * - onClose?: () => void (callback when mobile drawer closes)\r\n * - hideToggle?: boolean (hide floating hamburger when true)\r\n *\r\n * Notes:\r\n * - Manager and Employee sidebars intentionally differ from Admin.\r\n * - The component includes an internal ScheduleModal used by Managers.\r\n * - Replace fetch endpoints (/api/...) to match your backend.\r\n */\r\n\r\ntype Portal = \"admin\" | \"manager\" | \"employee\" | undefined;\r\n\r\ntype Props = {\r\n  portal?: Portal;\r\n  isOpen?: boolean;\r\n  onClose?: () => void;\r\n  hideToggle?: boolean;\r\n};\r\n\r\ntype NavItem = {\r\n  id: string;\r\n  label: string;\r\n  href: string;\r\n  icon: React.ComponentType<any>;\r\n  gradient?: string;\r\n  badge?: number | null;\r\n};\r\n\r\nfunction formatPath(raw: string | null | undefined) {\r\n  if (!raw) return \"/\";\r\n  return raw === \"/\" ? \"/\" : raw.replace(/\\/+$/, \"\");\r\n}\r\n\r\n/* ------------------- Simple Schedule Modal (Manager-only) ------------------- */\r\nfunction ScheduleModal({\r\n  open,\r\n  onClose,\r\n  onCreated,\r\n  defaultOrganizer,\r\n}: {\r\n  open: boolean;\r\n  onClose: (success?: boolean) => void;\r\n  onCreated?: (data: any) => void;\r\n  defaultOrganizer?: string | null;\r\n}) {\r\n  const [organizer, setOrganizer] = useState(defaultOrganizer ?? \"\");\r\n  const [datetime, setDatetime] = useState(\"\");\r\n  const [reminder, setReminder] = useState<number>(10);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    if (open) {\r\n      setOrganizer(defaultOrganizer ?? \"\");\r\n      setDatetime(\"\");\r\n      setReminder(10);\r\n      setError(null);\r\n    }\r\n  }, [open, defaultOrganizer]);\r\n\r\n  const handleSubmit = async (e?: React.FormEvent) => {\r\n    e?.preventDefault();\r\n    setError(null);\r\n    if (!organizer || !datetime) {\r\n      setError(\"Please provide an organizer and meeting date/time.\");\r\n      return;\r\n    }\r\n    // Basic ISO date validation\r\n    const dt = new Date(datetime);\r\n    if (Number.isNaN(dt.getTime())) {\r\n      setError(\"Invalid date/time.\");\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    try {\r\n      // POST to scheduling endpoint - adapt to your backend\r\n      const res = await fetch(\"/api/schedule/create\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ organizer, sendAt: dt.toISOString(), reminderMinutes: reminder }),\r\n        credentials: \"same-origin\",\r\n      });\r\n      const json = await res.json();\r\n      if (!res.ok) {\r\n        throw new Error(json?.message || \"Failed to schedule meeting\");\r\n      }\r\n      onCreated?.(json);\r\n      onClose(true);\r\n    } catch (err: any) {\r\n      setError(err?.message || \"Network error\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  if (!open) return null;\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center p-4 sm:p-6\">\r\n      <div className=\"absolute inset-0 bg-black/40\" onClick={() => onClose(false)} />\r\n      <motion.div\r\n        initial={{ scale: 0.98, opacity: 0 }}\r\n        animate={{ scale: 1, opacity: 1 }}\r\n        transition={{ duration: 0.12 }}\r\n        className=\"relative w-full max-w-md bg-white rounded-2xl p-6 shadow-xl z-10\"\r\n      >\r\n        <div className=\"flex items-center justify-between mb-4\">\r\n          <h3 className=\"text-lg font-semibold\">Schedule meeting</h3>\r\n          <button className=\"p-1 rounded-md hover:bg-slate-100\" onClick={() => onClose(false)}>\r\n            <X className=\"w-4 h-4\" />\r\n          </button>\r\n        </div>\r\n\r\n        <form onSubmit={(e) => handleSubmit(e)} className=\"space-y-3\">\r\n          <div>\r\n            <label className=\"text-xs text-slate-600\">Organizer</label>\r\n            <input\r\n              value={organizer}\r\n              onChange={(e) => setOrganizer(e.target.value)}\r\n              className=\"w-full mt-1 p-2 border rounded-md text-sm\"\r\n              placeholder=\"Organizer name or email\"\r\n            />\r\n          </div>\r\n\r\n          <div>\r\n            <label className=\"text-xs text-slate-600\">Date & time</label>\r\n            <input\r\n              type=\"datetime-local\"\r\n              value={datetime}\r\n              onChange={(e) => setDatetime(e.target.value)}\r\n              className=\"w-full mt-1 p-2 border rounded-md text-sm\"\r\n            />\r\n          </div>\r\n\r\n          <div>\r\n            <label className=\"text-xs text-slate-600\">Reminder (before meeting)</label>\r\n            <select value={String(reminder)} onChange={(e) => setReminder(Number(e.target.value))} className=\"w-full mt-1 p-2 border rounded-md text-sm\">\r\n              {[10, 20, 30, 40, 50, 60].map((m) => (\r\n                <option key={m} value={m}>\r\n                  {m} minutes before\r\n                </option>\r\n              ))}\r\n            </select>\r\n            <p className=\"text-xs text-slate-400 mt-1\">Reminder will be scheduled as: meeting_time - reminder.</p>\r\n          </div>\r\n\r\n          {error && <div className=\"text-sm text-rose-600\">{error}</div>}\r\n\r\n          <div className=\"flex items-center justify-end gap-2 pt-2\">\r\n            <button type=\"button\" className=\"px-3 py-1 rounded-md text-sm\" onClick={() => onClose(false)} disabled={loading}>\r\n              Cancel\r\n            </button>\r\n            <button type=\"submit\" disabled={loading} className=\"px-4 py-2 rounded-md bg-slate-900 text-white text-sm flex items-center gap-2\">\r\n              {loading ? \"Scheduling…\" : \"Schedule\"}\r\n            </button>\r\n          </div>\r\n        </form>\r\n      </motion.div>\r\n    </div>\r\n  );\r\n}\r\n\r\n/* ------------------- Sidebar Component ------------------- */\r\nexport default function Sidebar({ portal = \"admin\", isOpen: isOpenProp, onClose, hideToggle = false }: Props) {\r\n  const raw = usePathname();\r\n  const pathname = formatPath(raw);\r\n\r\n  // mobile open controlled/uncontrolled\r\n  const [internalOpen, setInternalOpen] = useState(false);\r\n  const openControlled = typeof isOpenProp === \"boolean\";\r\n  const open = openControlled ? isOpenProp! : internalOpen;\r\n  const setOpen = (next: boolean) => {\r\n    if (openControlled) {\r\n      if (!next && onClose) onClose();\r\n    } else {\r\n      setInternalOpen(next);\r\n      if (!next && onClose) onClose();\r\n    }\r\n  };\r\n\r\n  // UI state\r\n  const [searchQuery, setSearchQuery] = useState(\"\");\r\n  const [hoveredItem, setHoveredItem] = useState<string | null>(null);\r\n  const closeBtnRef = useRef<HTMLButtonElement | null>(null);\r\n\r\n  // manager-specific state\r\n  const [scheduleOpen, setScheduleOpen] = useState(false);\r\n  const [teams, setTeams] = useState<Array<{ id: string; name: string }>>([]);\r\n  const [teamsLoading, setTeamsLoading] = useState(false);\r\n  const [currentTeamId, setCurrentTeamId] = useState<string | null>(null);\r\n\r\n  // keyboard esc to close\r\n  useEffect(() => {\r\n    function onEsc(e: KeyboardEvent) {\r\n      if (e.key === \"Escape\") setOpen(false);\r\n    }\r\n    window.addEventListener(\"keydown\", onEsc);\r\n    return () => window.removeEventListener(\"keydown\", onEsc);\r\n  }, [isOpenProp]);\r\n\r\n  useEffect(() => {\r\n    if (open) closeBtnRef.current?.focus();\r\n  }, [open]);\r\n\r\n  // Load teams for managers (only when manager portal active)\r\n  useEffect(() => {\r\n    let mounted = true;\r\n    if (portal !== \"manager\") return;\r\n    setTeamsLoading(true);\r\n    (async () => {\r\n      try {\r\n        const res = await fetch(\"/api/dashboard/teams\", { credentials: \"same-origin\" });\r\n        if (!res.ok) {\r\n          setTeams([]);\r\n          return;\r\n        }\r\n        const json = await res.json();\r\n        const list = Array.isArray(json) ? json : json?.teams ?? [];\r\n        if (mounted) {\r\n          setTeams(list);\r\n          if (list.length > 0 && !currentTeamId) setCurrentTeamId(list[0].id);\r\n        }\r\n      } catch (e) {\r\n        if (mounted) setTeams([]);\r\n      } finally {\r\n        if (mounted) setTeamsLoading(false);\r\n      }\r\n    })();\r\n    return () => {\r\n      mounted = false;\r\n    };\r\n  }, [portal]);\r\n\r\n  /* ------------------- NAV CONFIGS ------------------- */\r\n  const NAV_ADMIN: NavItem[] = [\r\n    { id: \"overview\", label: \"Overview\", href: \"/dashboard/admin/overview\", icon: LayoutDashboard, gradient: \"from-blue-500 to-cyan-500\" },\r\n    { id: \"inbox\", label: \"Inbox\", href: \"/dashboard/admin/inbox\", icon: Inbox, gradient: \"from-emerald-500 to-teal-500\", badge: 12 },\r\n    { id: \"sent\", label: \"Sent\", href: \"/dashboard/admin/sent\", icon: Send, gradient: \"from-violet-500 to-purple-500\" },\r\n    { id: \"teams\", label: \"Teams\", href: \"/dashboard/admin/teams\", icon: Users, gradient: \"from-orange-500 to-rose-500\" },\r\n    { id: \"analytics\", label: \"Analytics\", href: \"/dashboard/admin/analytics\", icon: BarChart3, gradient: \"from-pink-500 to-rose-500\" },\r\n    { id: \"settings\", label: \"Settings\", href: \"/dashboard/admin/settings\", icon: Settings, gradient: \"from-slate-500 to-slate-700\" },\r\n  ];\r\n\r\n  const NAV_MANAGER: NavItem[] = [\r\n    { id: \"dashboard\", label: \"Dashboard\", href: \"/dashboard/manager/overview\", icon: LayoutDashboard, gradient: \"from-blue-500 to-cyan-500\" },\r\n    { id: \"team-inbox\", label: \"Team Inbox\", href: \"/dashboard/manager/TeamInbox\", icon: Inbox, gradient: \"from-emerald-500 to-teal-500\" },\r\n    \r\n    { id: \"tasks\", label: \"Tasks\", href: \"/dashboard/manager/Tasks\", icon: Clipboard, gradient: \"from-pink-500 to-rose-500\" },\r\n    { id: \"people\", label: \"People\", href: \"/dashboard/manager/People\", icon: User, gradient: \"from-teal-500 to-emerald-500\" },\r\n    { id: \"analytics\", label: \"Analytics\", href: \"/dashboard/manager/Analytics\", icon: BarChart3, gradient: \"from-pink-500 to-rose-500\" },\r\n    { id: \"settings\", label: \"Settings\", href: \"/dashboard/manager/settings\", icon: Settings, gradient: \"from-slate-500 to-slate-700\" },\r\n  ];\r\n\r\n  const NAV_EMPLOYEE: NavItem[] = [\r\n    { id: \"inbox\", label: \"Inbox\", href: \"/dashboard/employee/Inbox\", icon: Inbox, gradient: \"from-emerald-500 to-teal-500\" },\r\n    { id: \"my-tasks\", label: \"My Tasks\", href: \"/dashboard/employee/tasks\", icon: Clipboard, gradient: \"from-pink-500 to-rose-500\" },\r\n    { id: \"my-schedule\", label: \"My Schedule\", href: \"/dashboard/employee/schedule\", icon: Calendar, gradient: \"from-violet-500 to-purple-500\" },\r\n    {id:  \"my-team\", label: \"My Team\", href:\"/dashboard/employee/myteam\", icon: Users, gradient : \"from-emerald-500 to-teal-500\"},\r\n     ];\r\n\r\n  const NAV = portal === \"admin\" ? NAV_ADMIN : portal === \"manager\" ? NAV_MANAGER : NAV_EMPLOYEE;\r\n\r\n  /* ------------------- Active computation ------------------- */\r\n  const computeActive = (p: string | undefined | null) => {\r\n    const t = formatPath(p);\r\n    if (portal === \"admin\") {\r\n      if (t.startsWith(\"/dashboard/admin/overview\")) return \"overview\";\r\n      if (t.startsWith(\"/dashboard/admin/inbox\")) return \"inbox\";\r\n      if (t.startsWith(\"/dashboard/admin/sent\")) return \"sent\";\r\n      if (t.startsWith(\"/dashboard/admin/teams\")) return \"teams\";\r\n      if (t.startsWith(\"/dashboard/admin/analytics\")) return \"analytics\";\r\n      if (t.startsWith(\"/dashboard/admin/settings\")) return \"settings\";\r\n    } else if (portal === \"manager\") {\r\n      if (t.startsWith(\"/dashboard/manager/overview\")) return \"dashboard\";\r\n      if (t.startsWith(\"/dashboard/manager/inbox\")) return \"team-inbox\";\r\n      if (t.startsWith(\"/dashboard/manager/team\")) return \"my-team\";\r\n      if (t.startsWith(\"/dashboard/manager/schedule\")) return \"schedule\";\r\n      if (t.startsWith(\"/dashboard/manager/tasks\")) return \"tasks\";\r\n      if (t.startsWith(\"/dashboard/manager/people\")) return \"people\";\r\n      if (t.startsWith(\"/dashboard/manager/analytics\")) return \"analytics\";\r\n      if (t.startsWith(\"/dashboard/manager/settings\")) return \"settings\";\r\n    } else {\r\n      if (t.startsWith(\"/dashboard/employee/Inbox\")) return \"inbox\";\r\n      if (t.startsWith(\"/dashboard/employee/tasks\")) return \"my-tasks\";\r\n      if (t.startsWith(\"/dashboard/employee/schedule\")) return \"my-schedule\";\r\n      if (t.startsWith(\"/dashboard/employee/knowledge\")) return \"knowledge\";\r\n      if (t.startsWith(\"/dashboard/employee/profile\")) return \"profile\";\r\n    }\r\n    return undefined;\r\n  };\r\n\r\n  const activeId = computeActive(pathname);\r\n\r\n  const filteredNav = NAV.filter((it) => it.label.toLowerCase().includes(searchQuery.toLowerCase()));\r\n\r\n  /* ------------------- Sidebar content ------------------- */\r\n  const sidebarContent = (isMobile = false) => (\r\n    <div className=\"flex flex-col h-full\">\r\n      {/* Header */}\r\n      <div className=\"p-6 pb-4\">\r\n        <motion.div initial={{ opacity: 0, y: -10 }} animate={{ opacity: 1, y: 0 }} transition={{ duration: 0.36 }} className=\"flex items-center gap-3 mb-6\">\r\n          <div className=\"relative\">\r\n            <div className=\"w-11 h-11 rounded-xl bg-gradient-to-br from-blue-600 via-cyan-500 to-emerald-500 flex items-center justify-center text-white font-bold shadow-lg shadow-blue-500/30\">S</div>\r\n            <motion.div className=\"absolute -top-1 -right-1 w-3 h-3 bg-emerald-400 rounded-full border-2 border-white\" animate={{ scale: [1, 1.2, 1] }} transition={{ duration: 2, repeat: Infinity }} />\r\n          </div>\r\n\r\n          <div className=\"flex-1\">\r\n            <div className=\"text-base font-bold bg-gradient-to-r from-slate-800 to-slate-600 bg-clip-text text-transparent\">SignalHub</div>\r\n            <div className=\"text-xs text-slate-500 font-medium flex items-center gap-1\">\r\n              <Sparkles className=\"w-3 h-3\" />\r\n              Unified Inbox\r\n            </div>\r\n          </div>\r\n        </motion.div>\r\n\r\n        {/* Manager team switcher (only visible to manager portal) */}\r\n        {portal === \"manager\" && (\r\n          <div className=\"mb-3\">\r\n            <label className=\"text-xs text-slate-500\">Team</label>\r\n            <div className=\"mt-2\">\r\n              {teamsLoading ? (\r\n                <div className=\"text-xs text-slate-400\">Loading teams…</div>\r\n              ) : (\r\n                <select value={currentTeamId ?? \"\"} onChange={(e) => setCurrentTeamId(e.target.value || null)} className=\"w-full p-2 rounded-md border text-sm\">\r\n                  {teams.length === 0 && <option value=\"\">No teams</option>}\r\n                  {teams.map((t) => (\r\n                    <option key={t.id} value={t.id}>\r\n                      {t.name}\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Search */}\r\n        <motion.div className=\"relative group\" initial={{ opacity: 0, scale: 0.98 }} animate={{ opacity: 1, scale: 1 }} transition={{ duration: 0.32, delay: 0.06 }}>\r\n          <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400 group-focus-within:text-blue-500 transition-colors\" />\r\n          <input\r\n            aria-label=\"Search navigation\"\r\n            placeholder=\"Search...\"\r\n            value={searchQuery}\r\n            onChange={(e) => setSearchQuery(e.target.value)}\r\n            className=\"w-full pl-10 pr-4 py-2.5 bg-slate-50 border border-slate-200 rounded-xl text-sm placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 focus:bg-white transition-all duration-200\"\r\n          />\r\n        </motion.div>\r\n      </div>\r\n\r\n      {/* Navigation */}\r\n      <nav className=\"flex-1 px-3 overflow-y-auto scrollbar-thin scrollbar-thumb-slate-300 scrollbar-track-transparent\" aria-label=\"Primary\">\r\n        <div className=\"space-y-1\">\r\n          {filteredNav.map((item, index) => {\r\n            const Icon = item.icon as any;\r\n            const isActive = activeId === item.id;\r\n            const isHovered = hoveredItem === item.id;\r\n\r\n            return (\r\n              <motion.div key={item.id} initial={{ opacity: 0, x: -18 }} animate={{ opacity: 1, x: 0 }} transition={{ duration: 0.28, delay: index * 0.03 }}>\r\n                <Link\r\n                  href={item.href}\r\n                  onClick={() => {\r\n                    if (isMobile) setOpen(false);\r\n                  }}\r\n                  onMouseEnter={() => setHoveredItem(item.id)}\r\n                  onMouseLeave={() => setHoveredItem(null)}\r\n                  className={clsx(\r\n                    \"relative flex items-center gap-3 px-3 py-3 rounded-xl text-sm font-medium transition-all duration-200 group\",\r\n                    isActive ? \"bg-gradient-to-r from-blue-50 to-cyan-50 text-blue-700 shadow-sm\" : \"text-slate-600 hover:bg-slate-50\"\r\n                  )}\r\n                  aria-current={isActive ? \"page\" : undefined}\r\n                >\r\n                  {isActive && (\r\n                    <motion.div layoutId=\"activeIndicator\" className=\"absolute left-0 top-1/2 -translate-y-1/2 w-1 h-8 bg-gradient-to-b from-blue-500 to-cyan-500 rounded-r-full\" transition={{ type: \"spring\", stiffness: 300, damping: 30 }} />\r\n                  )}\r\n\r\n                  <div className=\"relative\">\r\n                    <motion.div className={clsx(\"w-9 h-9 rounded-lg flex items-center justify-center transition-all duration-200\", isActive ? `bg-gradient-to-br ${item.gradient} shadow-lg` : \"bg-slate-100 group-hover:bg-slate-200\")} animate={isActive ? { scale: [1, 1.05, 1] } : {}}>\r\n                      <Icon className={clsx(\"w-4 h-4 transition-colors\", isActive ? \"text-white\" : \"text-slate-600\")} />\r\n                    </motion.div>\r\n\r\n                    {item.badge && (\r\n                      <motion.div initial={{ scale: 0 }} animate={{ scale: 1 }} className=\"absolute -top-1 -right-1 min-w-[18px] h-[18px] px-1 bg-gradient-to-br from-rose-500 to-pink-500 text-white text-[10px] font-bold rounded-full flex items-center justify-center shadow-lg\" aria-hidden=\"true\">\r\n                        {item.badge}\r\n                      </motion.div>\r\n                    )}\r\n                  </div>\r\n\r\n                  <span className=\"flex-1 text-left\">{item.label}</span>\r\n\r\n                  <motion.div initial={{ opacity: 0, x: -5 }} animate={{ opacity: isHovered && !isActive ? 1 : 0, x: isHovered && !isActive ? 0 : -5 }} transition={{ duration: 0.18 }} aria-hidden=\"true\">\r\n                    <ChevronRight className=\"w-4 h-4 text-slate-400\" />\r\n                  </motion.div>\r\n\r\n                  {isActive && (\r\n                    <motion.div initial={{ opacity: 0, scale: 0.8 }} animate={{ opacity: 1, scale: 1 }} transition={{ duration: 0.18 }}>\r\n                      <ArrowRight className=\"w-4 h-4 text-blue-600\" />\r\n                    </motion.div>\r\n                  )}\r\n                </Link>\r\n              </motion.div>\r\n            );\r\n          })}\r\n        </div>\r\n\r\n        {/* Quick actions (portal specific) */}\r\n        <motion.div initial={{ opacity: 0, y: 8 }} animate={{ opacity: 1, y: 0 }} transition={{ duration: 0.36, delay: 0.18 }} className=\"mt-6 mb-4 px-3\">\r\n          <div className=\"mb-2 text-xs font-semibold text-slate-400 uppercase tracking-wider\">Quick Actions</div>\r\n\r\n          {portal === \"admin\" && (\r\n            <div className=\"p-4 bg-gradient-to-br from-blue-500 to-cyan-500 rounded-xl text-white relative overflow-hidden group cursor-pointer hover:shadow-xl transition-shadow duration-300\">\r\n              <div className=\"relative\">\r\n                <div className=\"text-sm font-bold mb-1\">Invite managers</div>\r\n                <div className=\"text-xs opacity-90 mb-3\">Send an invite to a new manager</div>\r\n                <motion.div className=\"inline-flex items-center gap-1 text-xs font-semibold bg-white/20 backdrop-blur-sm px-3 py-1.5 rounded-lg\" whileHover={{ scale: 1.05 }} whileTap={{ scale: 0.95 }}>\r\n                  Invite <ArrowRight className=\"w-3 h-3\" />\r\n                </motion.div>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {portal === \"manager\" && (\r\n            <>\r\n              <div className=\"flex gap-2\">\r\n                <button onClick={() => setScheduleOpen(true)} className=\"flex-1 inline-flex items-center justify-center gap-2 rounded-md bg-indigo-600 text-white px-3 py-2 text-sm hover:bg-indigo-700 transition\">\r\n                  <Calendar className=\"w-4 h-4\" /> Schedule meeting\r\n                </button>\r\n                <button className=\"inline-flex items-center gap-2 rounded-md border border-slate-200 px-3 py-2 text-sm\" onClick={() => {\r\n                  // client-side shortcut to create task - adapt to your create task flow\r\n                  window.location.href = \"/dashboard/manager/tasks/create\";\r\n                }}>\r\n                  <Plus className=\"w-4 h-4\" /> Task\r\n                </button>\r\n              </div>\r\n              <p className=\"text-xs text-slate-400 mt-2\">Quickly schedule meetings for your team or create tasks.</p>\r\n            </>\r\n          )}\r\n\r\n          {portal === \"employee\" && (\r\n            <>\r\n              <div className=\"flex gap-2\">\r\n                <button className=\"flex-1 inline-flex items-center justify-center gap-2 rounded-md bg-emerald-600 text-white px-3 py-2 text-sm hover:bg-emerald-700 transition\" onClick={() => {\r\n                  // start break / status toggle (demo client-side action)\r\n                  fetch(\"/api/me/status\", { method: \"POST\", credentials: \"same-origin\", body: JSON.stringify({ onBreak: true }) }).catch(() => {});\r\n                }}>\r\n                  <Clock className=\"w-4 h-4\" /> Start break\r\n                </button>\r\n                <button className=\"inline-flex items-center gap-2 rounded-md border border-slate-200 px-3 py-2 text-sm\" onClick={() => window.location.href = \"/dashboard/employee/notes/create\"}>\r\n                  <Plus className=\"w-4 h-4\" /> Note\r\n                </button>\r\n              </div>\r\n              <p className=\"text-xs text-slate-400 mt-2\">Set your status or jot down a quick note.</p>\r\n            </>\r\n          )}\r\n        </motion.div>\r\n      </nav>\r\n\r\n      {/* Profile section */}\r\n      <div className=\"p-4 border-t border-slate-200 bg-slate-50/50\">\r\n        <ProfileMenu />\r\n      </div>\r\n\r\n      {/* Schedule Modal (manager only) */}\r\n      {portal === \"manager\" && (\r\n        <ScheduleModal\r\n          open={scheduleOpen}\r\n          onClose={(success?: boolean) => {\r\n            setScheduleOpen(false);\r\n            if (success) {\r\n              // optional toast or action - simple page reload to refresh schedule\r\n              // window.location.reload();\r\n            }\r\n          }}\r\n          onCreated={() => {\r\n            // placeholder hook\r\n          }}\r\n          defaultOrganizer={undefined}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n\r\n  /* ------------------- Render root (desktop + mobile) ------------------- */\r\n  return (\r\n    <>\r\n      {/* Floating mobile hamburger toggle */}\r\n      {!hideToggle && (\r\n        <div className=\"lg:hidden fixed top-4 left-4 z-50\">\r\n          <motion.button\r\n            whileHover={{ scale: 1.05 }}\r\n            whileTap={{ scale: 0.95 }}\r\n            aria-label={open ? \"Close menu\" : \"Open menu\"}\r\n            onClick={() => setOpen(!open)}\r\n            className=\"p-3 rounded-xl bg-white shadow-lg shadow-slate-900/10 text-slate-700 border border-slate-200 backdrop-blur-sm\"\r\n          >\r\n            <AnimatePresence mode=\"wait\">\r\n              {open ? (\r\n                <motion.div key=\"close\" initial={{ rotate: -90, opacity: 0 }} animate={{ rotate: 0, opacity: 1 }} exit={{ rotate: 90, opacity: 0 }} transition={{ duration: 0.18 }}>\r\n                  <X className=\"w-5 h-5\" />\r\n                </motion.div>\r\n              ) : (\r\n                <motion.div key=\"menu\" initial={{ rotate: 90, opacity: 0 }} animate={{ rotate: 0, opacity: 1 }} exit={{ rotate: -90, opacity: 0 }} transition={{ duration: 0.18 }}>\r\n                  <Menu className=\"w-5 h-5\" />\r\n                </motion.div>\r\n              )}\r\n            </AnimatePresence>\r\n          </motion.button>\r\n        </div>\r\n      )}\r\n\r\n      {/* Desktop fixed sidebar */}\r\n      <motion.aside initial={{ x: -12, opacity: 0 }} animate={{ x: 0, opacity: 1 }} transition={{ duration: 0.36 }} className=\"hidden lg:fixed lg:inset-y-0 lg:left-0 lg:flex lg:flex-col lg:w-72 lg:min-h-screen lg:border-r lg:border-slate-200 lg:bg-white/80 lg:backdrop-blur-xl z-30\" aria-hidden={false}>\r\n        {sidebarContent(false)}\r\n      </motion.aside>\r\n\r\n      {/* Mobile drawer */}\r\n      <AnimatePresence>\r\n        {open && (\r\n          <>\r\n            <motion.div className=\"fixed inset-0 z-40 bg-slate-900/60 backdrop-blur-sm\" initial={{ opacity: 0 }} animate={{ opacity: 1 }} exit={{ opacity: 0 }} transition={{ duration: 0.28 }} onClick={() => setOpen(false)} aria-hidden=\"true\" />\r\n\r\n            <motion.aside initial={{ x: \"-100%\", opacity: 0 }} animate={{ x: 0, opacity: 1 }} exit={{ x: \"-100%\", opacity: 0 }} transition={{ type: \"spring\", stiffness: 300, damping: 30 }} className=\"fixed inset-y-0 left-0 z-50 w-80 bg-white shadow-2xl\" role=\"dialog\" aria-modal=\"true\" aria-label=\"Main menu\">\r\n              <div className=\"absolute top-4 right-4 z-10\">\r\n                <motion.button ref={closeBtnRef} whileHover={{ scale: 1.1, rotate: 90 }} whileTap={{ scale: 0.9 }} className=\"p-2 rounded-lg bg-slate-100 hover:bg-slate-200 text-slate-700 transition-colors\" aria-label=\"Close menu\" onClick={() => setOpen(false)}>\r\n                  <X className=\"w-5 h-5\" />\r\n                </motion.button>\r\n              </div>\r\n\r\n              {sidebarContent(true)}\r\n            </motion.aside>\r\n          </>\r\n        )}\r\n      </AnimatePresence>\r\n    </>\r\n  );\r\n}\r\n"],"names":["React","useEffect","useRef","useState","Link","usePathname","clsx","motion","AnimatePresence","LayoutDashboard","Inbox","Send","Users","BarChart3","Settings","Search","Menu","X","ChevronRight","Sparkles","ArrowRight","Calendar","Clock","Plus","Clipboard","Slack","User","CheckCircle","Bell","CalendarClock","ProfileMenu","Portal","Props","portal","isOpen","onClose","hideToggle","NavItem","id","label","href","icon","ComponentType","gradient","badge","formatPath","raw","replace","ScheduleModal","open","onCreated","defaultOrganizer","success","data","organizer","setOrganizer","datetime","setDatetime","reminder","setReminder","loading","setLoading","error","setError","handleSubmit","e","FormEvent","preventDefault","dt","Date","Number","isNaN","getTime","res","fetch","method","headers","body","JSON","stringify","sendAt","toISOString","reminderMinutes","credentials","json","ok","Error","message","err","scale","opacity","duration","target","value","String","map","m","Sidebar","isOpenProp","pathname","internalOpen","setInternalOpen","openControlled","setOpen","next","searchQuery","setSearchQuery","hoveredItem","setHoveredItem","closeBtnRef","HTMLButtonElement","scheduleOpen","setScheduleOpen","teams","setTeams","Array","name","teamsLoading","setTeamsLoading","currentTeamId","setCurrentTeamId","onEsc","KeyboardEvent","key","window","addEventListener","removeEventListener","current","focus","mounted","list","isArray","length","NAV_ADMIN","NAV_MANAGER","NAV_EMPLOYEE","NAV","computeActive","p","t","startsWith","undefined","activeId","filteredNav","filter","it","toLowerCase","includes","sidebarContent","isMobile","y","repeat","Infinity","delay","item","index","Icon","isActive","isHovered","x","type","stiffness","damping","location","onBreak","catch","rotate"],"mappings":"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","ignoreList":[],"debugId":null}},
    {"offset": {"line": 1933, "column": 0}, "map": {"version":3,"sources":["file:///E:/Attack%20Capital/SignalHub/frontend/src/lib/socketClient.ts"],"sourcesContent":["// src/lib/socketClient.ts\r\n\r\nimport { io, Socket } from \"socket.io-client\";\r\n\r\nconst DEFAULT_SOCKET_URL = (process.env.NEXT_PUBLIC_SOCKET_URL || \"http://localhost:4001\").replace(/\\/$/, \"\");\r\nconst DEFAULT_PATH = \"/\"; // if your socket server serves at root; otherwise adjust\r\n\r\nlet socket: Socket | null = null;\r\nlet currentToken: string | null = null;\r\n\r\n/**\r\n * createSocket() - internal helper to (re)create socket with token\r\n */\r\nfunction createSocket(token?: string) {\r\n  const url = DEFAULT_SOCKET_URL;\r\n  const opts: any = {\r\n    path: DEFAULT_PATH,\r\n    transports: [\"websocket\"],\r\n    autoConnect: false,\r\n    reconnection: true,\r\n    reconnectionAttempts: Infinity,\r\n    reconnectionDelayMax: 5000,\r\n    timeout: 20000,\r\n  };\r\n\r\n  if (token) {\r\n    opts.auth = { token };\r\n  }\r\n\r\n  const s = io(url, opts);\r\n  // helpful debug logs\r\n  s.on(\"connect\", () => {\r\n    // eslint-disable-next-line no-console\r\n    console.debug(\"[socket] connected\", s.id);\r\n  });\r\n  s.on(\"connect_error\", (err: any) => {\r\n    // eslint-disable-next-line no-console\r\n    console.warn(\"[socket] connect_error\", err && err.message ? err.message : err);\r\n  });\r\n  s.on(\"disconnect\", (reason: any) => {\r\n    // eslint-disable-next-line no-console\r\n    console.debug(\"[socket] disconnected\", reason);\r\n  });\r\n\r\n  return s;\r\n}\r\n\r\n/**\r\n * connectWithToken(token)\r\n * - creates (or recreates) the socket with token and connects\r\n */\r\nexport async function connectWithToken(token?: string) {\r\n  // prefer explicit token, otherwise attempt to read global/local fallback\r\n  const t = token ?? (typeof window !== \"undefined\" ? (window as any).__SESSION_TOKEN ?? (localStorage.getItem(\"session\") ?? null) : null);\r\n  currentToken = t;\r\n\r\n  // if socket exists and token unchanged, just ensure connected\r\n  if (socket && socket.connected && currentToken === t) {\r\n    return socket;\r\n  }\r\n\r\n  // if socket exists but token changed, clean up\r\n  if (socket) {\r\n    try {\r\n      socket.removeAllListeners();\r\n      socket.disconnect();\r\n    } catch {}\r\n    socket = null;\r\n  }\r\n\r\n  socket = createSocket(t ?? undefined);\r\n\r\n  // Connect\r\n  try {\r\n    socket.connect();\r\n    // wait for connect with a Promise (timeout)\r\n    await new Promise<void>((resolve, reject) => {\r\n      const to = setTimeout(() => {\r\n        // don't reject — leave to app to handle offline mode\r\n        clearTimeout(to);\r\n        resolve();\r\n      }, 3000);\r\n      socket!.once(\"connect\", () => {\r\n        clearTimeout(to);\r\n        resolve();\r\n      });\r\n      socket!.once(\"connect_error\", () => {\r\n        clearTimeout(to);\r\n        resolve(); // resolve so UI can continue; connection may recover\r\n      });\r\n    });\r\n  } catch (err) {\r\n    // swallow; connect errors are non-fatal for UI\r\n  }\r\n\r\n  return socket;\r\n}\r\n\r\n/**\r\n * disconnectSocket()\r\n */\r\nexport function disconnectSocket() {\r\n  try {\r\n    if (socket) {\r\n      socket.disconnect();\r\n      socket.removeAllListeners();\r\n      socket = null;\r\n      currentToken = null;\r\n    }\r\n  } catch {}\r\n}\r\n\r\n/**\r\n * joinRoom / leaveRoom helpers\r\n * rooms are plain strings (e.g., `chat:abc`, `user:xxx`, `org:yyy`)\r\n */\r\nexport async function joinRoom(room: string) {\r\n  if (!socket) await connectWithToken();\r\n  try {\r\n    socket?.emit(\"join_chat\", { chatId: room.startsWith(\"chat:\") ? room.split(\"chat:\")[1] : room });\r\n    // also call socket.join on server-side; client telling server via join_chat is typical\r\n  } catch {}\r\n}\r\n\r\nexport async function leaveRoom(room: string) {\r\n  try {\r\n    socket?.emit(\"leave_chat\", { chatId: room.startsWith(\"chat:\") ? room.split(\"chat:\")[1] : room });\r\n  } catch {}\r\n}\r\n\r\n/**\r\n * sendEvent(event, payload)\r\n */\r\nexport function sendEvent(event: string, payload?: any) {\r\n  try {\r\n    if (!socket) {\r\n      // call connectWithToken but do not await long\r\n      connectWithToken().then(() => {\r\n        socket?.emit(event, payload);\r\n      });\r\n      return;\r\n    }\r\n    socket.emit(event, payload);\r\n  } catch {}\r\n}\r\n\r\n/**\r\n * on(event, handler) / off(event, handler)\r\n */\r\nexport function onEvent(event: string, handler: (...args: any[]) => void) {\r\n  try {\r\n    if (!socket) {\r\n      // best-effort connect\r\n      connectWithToken().then(() => {\r\n        socket?.on(event, handler);\r\n      });\r\n      return;\r\n    }\r\n    socket.on(event, handler);\r\n  } catch {}\r\n}\r\n\r\nexport function offEvent(event: string, handler?: (...args: any[]) => void) {\r\n  try {\r\n    if (!socket) return;\r\n    if (handler) socket.off(event, handler);\r\n    else socket.removeAllListeners(event);\r\n  } catch {}\r\n}\r\n\r\n/**\r\n * getSocket() - returns the underlying socket instance (may be null)\r\n */\r\nexport function getSocketInstance() {\r\n  return socket;\r\n}\r\n\r\nexport default {\r\n  connectWithToken,\r\n  disconnectSocket,\r\n  joinRoom,\r\n  leaveRoom,\r\n  sendEvent,\r\n  onEvent,\r\n  offEvent,\r\n  getSocketInstance,\r\n};\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2115, "column": 0}, "map": {"version":3,"sources":["E:/Attack Capital/SignalHub/frontend/src/app/dashboard/ChatSocketProvider.tsx"],"sourcesContent":["// src/context/ChatSocketProvider.tsx\r\n\"use client\";\r\n\r\nimport React, { createContext, useCallback, useContext, useEffect, useMemo, useRef, useState } from \"react\";\r\nimport socketClient, { connectWithToken, disconnectSocket, joinRoom, leaveRoom, sendEvent, onEvent, offEvent } from \"@/lib/socketClient\";\r\n\r\n\r\n\r\ntype ChatSocketContextValue = {\r\n  connected: boolean;\r\n  socketId: string | null;\r\n  connect: (token?: string | null) => Promise<void>;\r\n  disconnect: () => void;\r\n  joinChat: (chatId: string) => Promise<void>;\r\n  leaveChat: (chatId: string) => Promise<void>;\r\n  sendMessage: (chatId: string, payload: any) => void;\r\n  on: (event: string, handler: (...args: any[]) => void) => void;\r\n  off: (event: string, handler?: (...args: any[]) => void) => void;\r\n};\r\n\r\nconst ChatSocketContext = createContext<ChatSocketContextValue | null>(null);\r\n\r\nexport function useChatSocket(): ChatSocketContextValue {\r\n  const ctx = useContext(ChatSocketContext);\r\n  if (!ctx) throw new Error(\"useChatSocket must be used inside ChatSocketProvider\");\r\n  return ctx;\r\n}\r\n\r\nexport function ChatSocketProvider({ children, getToken }: { children: React.ReactNode; getToken?: (() => Promise<string | null> | string | null) }) {\r\n  const [connected, setConnected] = useState(false);\r\n  const [socketId, setSocketId] = useState<string | null>(null);\r\n  const tokenRef = useRef<string | null>(null);\r\n\r\n  // internal handler that wires connect\r\n  const doConnect = useCallback(async (maybeToken?: string | null) => {\r\n    try {\r\n      let token = maybeToken ?? null;\r\n      if (!token && getToken) {\r\n        try {\r\n          const t = await (getToken as any)();\r\n          token = typeof t === \"string\" ? t : null;\r\n        } catch {}\r\n      }\r\n      // fallback global/local\r\n      if (!token && typeof window !== \"undefined\") {\r\n        token = (window as any).__SESSION_TOKEN ?? localStorage.getItem(\"session\") ?? null;\r\n      }\r\n\r\n      tokenRef.current = token;\r\n      const s = await connectWithToken(token);\r\n      const inst = s ?? (window as any).__socketInstance ?? null;\r\n\r\n      // wait a tick for connection state\r\n      setTimeout(() => {\r\n        setConnected(Boolean(inst && inst.connected));\r\n        setSocketId(inst?.id ?? null);\r\n      }, 300);\r\n\r\n      // subscribe to connect/disconnect to update state\r\n      if (inst) {\r\n        inst.on?.(\"connect\", () => {\r\n          setConnected(true);\r\n          setSocketId(inst.id ?? null);\r\n        });\r\n        inst.on?.(\"disconnect\", () => {\r\n          setConnected(false);\r\n          setSocketId(null);\r\n        });\r\n      }\r\n    } catch (err) {\r\n      // ignore\r\n    }\r\n  }, [getToken]);\r\n\r\n  const doDisconnect = useCallback(() => {\r\n    try {\r\n      disconnectSocket();\r\n    } finally {\r\n      setConnected(false);\r\n      setSocketId(null);\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    // auto-connect on mount\r\n    doConnect().catch(() => {});\r\n    // cleanup on unmount\r\n    return () => {\r\n      try {\r\n        doDisconnect();\r\n      } catch {}\r\n    };\r\n  }, [doConnect, doDisconnect]);\r\n\r\n  const joinChat = useCallback(async (chatId: string) => {\r\n    if (!chatId) return;\r\n    await joinRoom(`chat:${chatId}`);\r\n    // also set up listener for messages if needed elsewhere\r\n  }, []);\r\n\r\n  const leaveChat = useCallback(async (chatId: string) => {\r\n    if (!chatId) return;\r\n    await leaveRoom(`chat:${chatId}`);\r\n  }, []);\r\n\r\n  const sendMessage = useCallback((chatId: string, payload: any) => {\r\n    // send using standard event name; your server APIs also persist messages,\r\n    // but emitting here allows real-time UX. Use your API to persist (POST /api/chats/:id).\r\n    sendEvent(\"chat:message\", { chatId, ...payload });\r\n  }, []);\r\n\r\n  const on = useCallback((event: string, handler: (...args: any[]) => void) => {\r\n    onEvent(event, handler);\r\n  }, []);\r\n\r\n  const off = useCallback((event: string, handler?: (...args: any[]) => void) => {\r\n    offEvent(event, handler);\r\n  }, []);\r\n\r\n  const value = useMemo(\r\n    () => ({\r\n      connected,\r\n      socketId,\r\n      connect: doConnect,\r\n      disconnect: doDisconnect,\r\n      joinChat,\r\n      leaveChat,\r\n      sendMessage,\r\n      on,\r\n      off,\r\n    }),\r\n    [connected, socketId, doConnect, doDisconnect, joinChat, leaveChat, sendMessage, on, off]\r\n  );\r\n\r\n  return <ChatSocketContext.Provider value={value}>{children}</ChatSocketContext.Provider>;\r\n}\r\n"],"names":["c","_c","React","createContext","useCallback","useContext","useEffect","useMemo","useRef","useState","socketClient","connectWithToken","disconnectSocket","joinRoom","leaveRoom","sendEvent","onEvent","offEvent","ChatSocketContextValue","connected","socketId","connect","token","Promise","disconnect","joinChat","chatId","leaveChat","sendMessage","payload","on","event","handler","args","off","ChatSocketContext","useChatSocket","$","$i","Symbol","for","ctx","Error","ChatSocketProvider","children","getToken","ReactNode","setConnected","setSocketId","tokenRef","doConnect","maybeToken","t","window","__SESSION_TOKEN","localStorage","getItem","current","s","inst","__socketInstance","setTimeout","Boolean","id","err","doDisconnect","catch","value"],"mappings":"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","ignoreList":[],"debugId":null}},
    {"offset": {"line": 2306, "column": 0}, "map": {"version":3,"sources":["E:/Attack Capital/SignalHub/frontend/src/app/dashboard/layout.tsx"],"sourcesContent":["// app/dashboard/layout.tsx\r\n\"use client\";\r\n\r\nimport React, { useEffect, useState } from \"react\";\r\nimport type { ReactNode } from \"react\";\r\nimport Sidebar from \"@/components/ui/sidebar/Sidebar\";\r\nimport { ChatSocketProvider } from \"./ChatSocketProvider\";   // ⬅️ added import\r\n\r\ntype MeResponse = {\r\n  ok?: boolean;\r\n  role?: string;\r\n  user?: { id?: string; email?: string; role?: string; organizationId?: string; organizationName?: string };\r\n};\r\n\r\nexport default function DashboardLayout({ children }: { children: ReactNode }) {\r\n  const [loading, setLoading] = useState(true);\r\n  const [role, setRole] = useState<string | null>(null);\r\n  const [orgName, setOrgName] = useState<string | null>(null);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  // determine portal from role\r\n  const portal = role === \"ADMIN\" ? \"admin\" : role === \"MANAGER\" ? \"manager\" : \"employee\";\r\n\r\n  useEffect(() => {\r\n    let mounted = true;\r\n    setLoading(true);\r\n    (async () => {\r\n      try {\r\n        const res = await fetch(\"/api/me\", { credentials: \"include\" });\r\n        if (!res.ok) {\r\n          if (mounted) {\r\n            setRole(null);\r\n            setOrgName(null);\r\n            setError(\"Not authenticated\");\r\n            setLoading(false);\r\n          }\r\n          return;\r\n        }\r\n        const j: MeResponse = await res.json().catch(() => ({}));\r\n        const r = (j?.role ?? j?.user?.role ?? null) as string | null;\r\n        const org = (j?.user?.organizationName ?? null) as string | null;\r\n        if (mounted) {\r\n          setRole(r ? String(r).toUpperCase() : null);\r\n          setOrgName(org);\r\n          setError(null);\r\n          setLoading(false);\r\n        }\r\n      } catch (err: any) {\r\n        if (mounted) {\r\n          setError(err?.message || String(err));\r\n          setLoading(false);\r\n        }\r\n      }\r\n    })();\r\n\r\n    return () => {\r\n      mounted = false;\r\n    };\r\n  }, []);\r\n\r\n  // Loading skeleton\r\n  if (loading) {\r\n    return (\r\n      <ChatSocketProvider>\r\n        <div className=\"min-h-screen flex bg-slate-50\">\r\n          <aside className=\"w-72 p-6\">\r\n            <div className=\"h-8 w-36 rounded-lg bg-slate-200 animate-pulse mb-6\" />\r\n            <div className=\"space-y-3\">\r\n              <div className=\"h-10 rounded-lg bg-slate-200 animate-pulse\" />\r\n              <div className=\"h-10 rounded-lg bg-slate-200 animate-pulse\" />\r\n              <div className=\"h-10 rounded-lg bg-slate-200 animate-pulse\" />\r\n              <div className=\"h-10 rounded-lg bg-slate-200 animate-pulse\" />\r\n            </div>\r\n          </aside>\r\n\r\n          <div className=\"flex-1 p-6\">\r\n            <div className=\"h-8 w-1/3 rounded bg-slate-200 animate-pulse mb-4\" />\r\n            <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\r\n              <div className=\"lg:col-span-2 space-y-4\">\r\n                <div className=\"h-44 rounded bg-slate-200 animate-pulse\" />\r\n                <div className=\"h-44 rounded bg-slate-200 animate-pulse\" />\r\n              </div>\r\n              <div className=\"space-y-4\">\r\n                <div className=\"h-28 rounded bg-slate-200 animate-pulse\" />\r\n                <div className=\"h-28 rounded bg-slate-200 animate-pulse\" />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </ChatSocketProvider>\r\n    );\r\n  }\r\n\r\n  // Not signed in\r\n  if (!role) {\r\n    return (\r\n      <ChatSocketProvider>\r\n        <div className=\"min-h-screen flex items-center justify-center p-6 bg-slate-50\">\r\n          <div className=\"bg-white rounded-lg p-6 shadow\">\r\n            <h2 className=\"text-lg font-semibold\">Not signed in</h2>\r\n            <p className=\"text-sm text-slate-600 mt-2\">Please sign in to access the dashboard.</p>\r\n            <div className=\"mt-4 flex gap-2\">\r\n              <a href=\"/login\" className=\"px-3 py-2 rounded bg-indigo-600 text-white text-sm\">Sign in</a>\r\n              <a href=\"/\" className=\"px-3 py-2 rounded border text-sm\">Go home</a>\r\n            </div>\r\n            {error && <div className=\"mt-3 text-xs text-rose-600\">{error}</div>}\r\n          </div>\r\n        </div>\r\n      </ChatSocketProvider>\r\n    );\r\n  }\r\n\r\n  // Main dashboard layout\r\n  return (\r\n    <ChatSocketProvider>\r\n      <div className=\"min-h-screen flex bg-slate-50\">\r\n        {/* Sidebar */}\r\n        <Sidebar portal={portal as any} />\r\n\r\n        {/* Main content area */}\r\n        <div className=\"flex-1 min-h-screen lg:pl-72\">\r\n          {/* Header */}\r\n          <header className=\"bg-white border-b border-slate-200 sticky top-0 z-20\">\r\n            <div className=\"max-w-7xl mx-auto px-4 py-3 flex items-center justify-between gap-4\">\r\n              <div className=\"flex items-center gap-4\">\r\n                <button\r\n                  onClick={() => {\r\n                    const el = document.querySelector(\"button[aria-label='Open menu']\");\r\n                    if (el) (el as HTMLButtonElement).click();\r\n                  }}\r\n                  className=\"lg:hidden inline-flex items-center justify-center p-2 rounded-md bg-white border shadow-sm\"\r\n                  aria-label=\"Open menu\"\r\n                >\r\n                  <svg className=\"w-5 h-5\" viewBox=\"0 0 24 24\" fill=\"none\" aria-hidden>\r\n                    <path d=\"M4 6h16M4 12h16M4 18h16\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\" />\r\n                  </svg>\r\n                </button>\r\n\r\n                <div>\r\n                  <div className=\"text-sm font-semibold text-slate-800\">Dashboard</div>\r\n                  <div className=\"text-xs text-slate-500\">{orgName ?? \"Organization\"} • {role?.toLowerCase()}</div>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"flex items-center gap-3\">\r\n                <a href=\"/account\" className=\"hidden sm:inline-flex text-sm px-3 py-1 rounded-md hover:bg-slate-50\">Account</a>\r\n                <form action=\"/api/auth/logout\" method=\"POST\">\r\n                  <button type=\"submit\" className=\"px-3 py-1 rounded-md border text-sm\">Sign out</button>\r\n                </form>\r\n              </div>\r\n            </div>\r\n          </header>\r\n\r\n          <main className=\"p-6\">\r\n            <div className=\"max-w-7xl mx-auto\">{children}</div>\r\n          </main>\r\n        </div>\r\n      </div>\r\n    </ChatSocketProvider>\r\n  );\r\n}\r\n"],"names":["React","useEffect","useState","ReactNode","Sidebar","ChatSocketProvider","MeResponse","ok","role","user","id","email","organizationId","organizationName","DashboardLayout","children","loading","setLoading","setRole","orgName","setOrgName","error","setError","portal","mounted","res","fetch","credentials","j","json","catch","r","org","String","toUpperCase","err","message","el","document","querySelector","HTMLButtonElement","click","toLowerCase"],"mappings":"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","ignoreList":[],"debugId":null}}]
}